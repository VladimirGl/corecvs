<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DeepView: core/clegacy/sgm.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">DeepView
   &#160;<span id="projectnumber">0.02</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">core/clegacy/sgm.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is a header file for the <a class="el" href="sgm_8c.html" title="this file implements the fast and the research version of the SGM algorithm">sgm.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;g12buffer.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sgm.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sgm_8h__incl.svg" width="158" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sgm_8h__dep__incl.svg" width="158" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="sgm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a30916e274b5edb389d5ec7ec94e30297">PATH_LIMIT</a>&#160;&#160;&#160;12</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a329108486e4923172b6c41a54f7a4f98">PATH_TOP_BIT</a>&#160;&#160;&#160;(0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A list of defines that classify the path.  <a href="#a329108486e4923172b6c41a54f7a4f98"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#abec8f7e939258c7c7e892ac29faeaa19">PATH_TOP_RIGHT_BIT</a>&#160;&#160;&#160;(1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#ac77fd103f9fd6702d9eb92796a4c6c52">PATH_RIGHT_BIT</a>&#160;&#160;&#160;(2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#abea4d8aa75eda5ee29683000ba4ce2bf">PATH_BOTTOM_RIGHT_BIT</a>&#160;&#160;&#160;(3)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#abba20fe235efdebf653c1dcee39c4e03">PATH_BOTTOM_BIT</a>&#160;&#160;&#160;(4)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#afcf3d2ca434377be61f2d0f8b56bff70">PATH_BOTTOM_LEFT_BIT</a>&#160;&#160;&#160;(5)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a0ca150fc1944a001a960856a49e42d36">PATH_LEFT_BIT</a>&#160;&#160;&#160;(6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#ae8d5dd37cbacbdaf89bcf71068c88a96">PATH_TOP_LEFT_BIT</a>&#160;&#160;&#160;(7)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#afff3143a1e3324dcdf4be2edb8e6f517">PATH_TOP</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_TOP_BIT)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#ac8a1e829b3b9690d5fb0bbec99813720">PATH_TOP_RIGHT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_TOP_RIGHT_BIT)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#ae6b749cde3e93c27a2633aed7b31327b">PATH_RIGHT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_RIGHT_BIT)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#ac7c9bbf5f97ed5c82c8c02a0a02ac80b">PATH_BOTTOM_RIGHT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_BOTTOM_RIGHT_BIT)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a00aad835e962e3d2255105a7ac0b79ce">PATH_BOTTOM</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_BOTTOM_BIT)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a282c437a5c0c02679c519d220d662d2d">PATH_BOTTOM_LEFT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_BOTTOM_LEFT_BIT)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a4b4dce0fb5d6287ef06b5813f9987bb5">PATH_LEFT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_LEFT_BIT)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a96d1b03620973d98d5d1c118e47785d1">PATH_TOP_LEFT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_TOP_LEFT_BIT)</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a733737b45c4191360180f650d1211224">SGM_Progress_Callback</a> )(int pathNum, int persent)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">G12Buffer *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#af70448dac0e19cb4752638e1d4c26927">sgm_PC16</a> (G12Buffer *I, G12Buffer *J, int dMax, int closePenlty, int longPenalty, <a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **sArrayTest, <a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **cArrayTest, <a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **pArrayTest, <a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> mask, <a class="el" href="sgm_8h.html#a733737b45c4191360180f650d1211224">SGM_Progress_Callback</a> callback)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function implements the classical SGM algorithm (slow).  <a href="#af70448dac0e19cb4752638e1d4c26927"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">G12Buffer *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a1eba02afa0f6055c7630cfc7c102e251">sgmFastx86</a> (G12Buffer *left, G12Buffer *right, int dMax, int closePenlty, int longPenalty)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">G12Buffer *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sgm_8h.html#a716a595aaf9bcceb6628b980fbbb90ed">sgmFastx86v1</a> (G12Buffer *left, G12Buffer *right, int dMax, int closePenlty, int longPenalty)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This is a header file for the <a class="el" href="sgm_8c.html" title="this file implements the fast and the research version of the SGM algorithm">sgm.c</a>. </p>
<dl class="date"><dt><b>Date:</b></dt><dd>Apr 14, 2009 </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Alexander Pimenov </dd></dl>

<p>Definition in file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a00aad835e962e3d2255105a7ac0b79ce"></a><!-- doxytag: member="sgm.h::PATH_BOTTOM" ref="a00aad835e962e3d2255105a7ac0b79ce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#a00aad835e962e3d2255105a7ac0b79ce">PATH_BOTTOM</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_BOTTOM_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00044">44</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="abba20fe235efdebf653c1dcee39c4e03"></a><!-- doxytag: member="sgm.h::PATH_BOTTOM_BIT" ref="abba20fe235efdebf653c1dcee39c4e03" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#abba20fe235efdebf653c1dcee39c4e03">PATH_BOTTOM_BIT</a>&#160;&#160;&#160;(4)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00035">35</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="a282c437a5c0c02679c519d220d662d2d"></a><!-- doxytag: member="sgm.h::PATH_BOTTOM_LEFT" ref="a282c437a5c0c02679c519d220d662d2d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#a282c437a5c0c02679c519d220d662d2d">PATH_BOTTOM_LEFT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_BOTTOM_LEFT_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00045">45</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="afcf3d2ca434377be61f2d0f8b56bff70"></a><!-- doxytag: member="sgm.h::PATH_BOTTOM_LEFT_BIT" ref="afcf3d2ca434377be61f2d0f8b56bff70" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#afcf3d2ca434377be61f2d0f8b56bff70">PATH_BOTTOM_LEFT_BIT</a>&#160;&#160;&#160;(5)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00036">36</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac7c9bbf5f97ed5c82c8c02a0a02ac80b"></a><!-- doxytag: member="sgm.h::PATH_BOTTOM_RIGHT" ref="ac7c9bbf5f97ed5c82c8c02a0a02ac80b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#ac7c9bbf5f97ed5c82c8c02a0a02ac80b">PATH_BOTTOM_RIGHT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_BOTTOM_RIGHT_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00043">43</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="abea4d8aa75eda5ee29683000ba4ce2bf"></a><!-- doxytag: member="sgm.h::PATH_BOTTOM_RIGHT_BIT" ref="abea4d8aa75eda5ee29683000ba4ce2bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#abea4d8aa75eda5ee29683000ba4ce2bf">PATH_BOTTOM_RIGHT_BIT</a>&#160;&#160;&#160;(3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00034">34</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4b4dce0fb5d6287ef06b5813f9987bb5"></a><!-- doxytag: member="sgm.h::PATH_LEFT" ref="a4b4dce0fb5d6287ef06b5813f9987bb5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#a4b4dce0fb5d6287ef06b5813f9987bb5">PATH_LEFT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_LEFT_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00046">46</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0ca150fc1944a001a960856a49e42d36"></a><!-- doxytag: member="sgm.h::PATH_LEFT_BIT" ref="a0ca150fc1944a001a960856a49e42d36" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#a0ca150fc1944a001a960856a49e42d36">PATH_LEFT_BIT</a>&#160;&#160;&#160;(6)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00037">37</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="a30916e274b5edb389d5ec7ec94e30297"></a><!-- doxytag: member="sgm.h::PATH_LIMIT" ref="a30916e274b5edb389d5ec7ec94e30297" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#a30916e274b5edb389d5ec7ec94e30297">PATH_LIMIT</a>&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00024">24</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

<p>Referenced by <a class="el" href="sgm_8c_source.html#l00201">sgm_PC16()</a>.</p>

</div>
</div>
<a class="anchor" id="ae6b749cde3e93c27a2633aed7b31327b"></a><!-- doxytag: member="sgm.h::PATH_RIGHT" ref="ae6b749cde3e93c27a2633aed7b31327b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#ae6b749cde3e93c27a2633aed7b31327b">PATH_RIGHT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_RIGHT_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00042">42</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac77fd103f9fd6702d9eb92796a4c6c52"></a><!-- doxytag: member="sgm.h::PATH_RIGHT_BIT" ref="ac77fd103f9fd6702d9eb92796a4c6c52" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#ac77fd103f9fd6702d9eb92796a4c6c52">PATH_RIGHT_BIT</a>&#160;&#160;&#160;(2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00033">33</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="afff3143a1e3324dcdf4be2edb8e6f517"></a><!-- doxytag: member="sgm.h::PATH_TOP" ref="afff3143a1e3324dcdf4be2edb8e6f517" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#afff3143a1e3324dcdf4be2edb8e6f517">PATH_TOP</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_TOP_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00040">40</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="a329108486e4923172b6c41a54f7a4f98"></a><!-- doxytag: member="sgm.h::PATH_TOP_BIT" ref="a329108486e4923172b6c41a54f7a4f98" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#a329108486e4923172b6c41a54f7a4f98">PATH_TOP_BIT</a>&#160;&#160;&#160;(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A list of defines that classify the path. </p>
<p>@{ </p>

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00031">31</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="a96d1b03620973d98d5d1c118e47785d1"></a><!-- doxytag: member="sgm.h::PATH_TOP_LEFT" ref="a96d1b03620973d98d5d1c118e47785d1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#a96d1b03620973d98d5d1c118e47785d1">PATH_TOP_LEFT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_TOP_LEFT_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00047">47</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae8d5dd37cbacbdaf89bcf71068c88a96"></a><!-- doxytag: member="sgm.h::PATH_TOP_LEFT_BIT" ref="ae8d5dd37cbacbdaf89bcf71068c88a96" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#ae8d5dd37cbacbdaf89bcf71068c88a96">PATH_TOP_LEFT_BIT</a>&#160;&#160;&#160;(7)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00038">38</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac8a1e829b3b9690d5fb0bbec99813720"></a><!-- doxytag: member="sgm.h::PATH_TOP_RIGHT" ref="ac8a1e829b3b9690d5fb0bbec99813720" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#ac8a1e829b3b9690d5fb0bbec99813720">PATH_TOP_RIGHT</a>&#160;&#160;&#160;(0x1 &lt;&lt; PATH_TOP_RIGHT_BIT)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00041">41</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<a class="anchor" id="abec8f7e939258c7c7e892ac29faeaa19"></a><!-- doxytag: member="sgm.h::PATH_TOP_RIGHT_BIT" ref="abec8f7e939258c7c7e892ac29faeaa19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="sgm_8h.html#abec8f7e939258c7c7e892ac29faeaa19">PATH_TOP_RIGHT_BIT</a>&#160;&#160;&#160;(1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00032">32</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a733737b45c4191360180f650d1211224"></a><!-- doxytag: member="sgm.h::SGM_Progress_Callback" ref="a733737b45c4191360180f650d1211224" args=")(int pathNum, int persent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="sgm_8h.html#a733737b45c4191360180f650d1211224">SGM_Progress_Callback</a>)(int pathNum, int persent)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8h_source.html#l00051">51</a> of file <a class="el" href="sgm_8h_source.html">sgm.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="af70448dac0e19cb4752638e1d4c26927"></a><!-- doxytag: member="sgm.h::sgm_PC16" ref="af70448dac0e19cb4752638e1d4c26927" args="(G12Buffer *I, G12Buffer *J, int dMax, int closePenlty, int longPenalty, uint32_t **sArrayTest, uint32_t **cArrayTest, uint32_t **pArrayTest, uint32_t mask, SGM_Progress_Callback callback)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G12Buffer* <a class="el" href="sgm_8h.html#af70448dac0e19cb4752638e1d4c26927">sgm_PC16</a> </td>
          <td>(</td>
          <td class="paramtype">G12Buffer *&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G12Buffer *&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>closePenlty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>longPenalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **&#160;</td>
          <td class="paramname"><em>sArrayTest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **&#160;</td>
          <td class="paramname"><em>cArrayTest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **&#160;</td>
          <td class="paramname"><em>pArrayTest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sgm_8h.html#a733737b45c4191360180f650d1211224">SGM_Progress_Callback</a>&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function implements the classical SGM algorithm (slow). </p>

<p>Definition at line <a class="el" href="sgm_8c_source.html#l00201">201</a> of file <a class="el" href="sgm_8c_source.html">sgm.c</a>.</p>

<p>References <a class="el" href="sgm_8c_source.html#l00058">ADDR</a>, <a class="el" href="global_8h_source.html#l00105">ASSERT_FAIL</a>, <a class="el" href="sgm_8c_source.html#l00171">computeCostArray()</a>, <a class="el" href="global_8h_source.html#l00152">dv_calloc</a>, <a class="el" href="global_8h_source.html#l00153">dv_free</a>, <a class="el" href="global_8h_source.html#l00151">dv_malloc</a>, <a class="el" href="sgm_8c_source.html#l00032">PathDescription_TAG::dx</a>, <a class="el" href="sgm_8c_source.html#l00031">PathDescription_TAG::dy</a>, <a class="el" href="sgm_8c_source.html#l00033">PathDescription_TAG::isVertical</a>, <a class="el" href="sgm_8c_source.html#l00089">min4()</a>, <a class="el" href="sgm_8h_source.html#l00024">PATH_LIMIT</a>, and <a class="el" href="stdint__win_8h_source.html#l00128">UINT32_MAX</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> (I == NULL || J == NULL)
                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;null parameters not supported&quot;</span>);
        <span class="keywordflow">if</span> (I-&gt;h != J-&gt;h || I-&gt;w != J-&gt;w)
                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Buffers have different sizes&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *Carray;
    <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *Sarray;
    <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *Parray;

        <span class="keywordtype">int</span> i,j,d;

        <span class="keywordtype">int</span> isInverted = dMax &lt; 0;
        dMax = isInverted ? -dMax : dMax;


        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *Lcost = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (dMax * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *));
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *Lcost1 = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (dMax * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *));
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *costs;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *costs1;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *tmp;

        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> min;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> oldmin;

        <span class="keywordtype">int</span> dx, dy;
        <span class="keywordtype">int</span> x,y;


        <span class="keywordtype">int</span> arraySize = dMax * I-&gt;h * I-&gt;w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>);

        <span class="keywordflow">if</span> (pArrayTest != NULL)
        {

                <span class="keywordtype">int</span> storageAlloc = arraySize * <a class="code" href="sgm_8h.html#a30916e274b5edb389d5ec7ec94e30297">PATH_LIMIT</a>;
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                <span class="keywordflow">if</span> (storageAlloc / PATH_LIMIT != arraySize)
                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;An integer overflow selecting the debug buffer. Sorry.&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
                printf(<span class="stringliteral">&quot;%d bits will be used to store the debug data.\n&quot;</span>, storageAlloc);
                Parray = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (storageAlloc);
        }

        Carray = <a class="code" href="sgm_8c.html#ad70da39bbe4545e027eb6ea182f37b62" title="This function uses a lot of space.">computeCostArray</a>(I, J, dMax, isInverted);
        Sarray = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#aafb8dc40c351b159e69943a68008edf4">dv_calloc</a> (arraySize, 1);


        <span class="comment">// Traverse all the paths types</span>

        <span class="keywordtype">int</span> pathcount;
        <span class="keywordflow">for</span> (pathcount = 0; pathcount &lt; <a class="code" href="sgm_8h.html#a30916e274b5edb389d5ec7ec94e30297">PATH_LIMIT</a>; pathcount++)
        {
                <span class="keywordflow">if</span> (!(<a class="code" href="sgm_8c.html#aa42d05340ff794ee78aedf33ad1ed7b0">pathList</a>[pathcount].pathClass &amp; mask))
                        <span class="keywordflow">continue</span>;

                dy = <a class="code" href="sgm_8c.html#aa42d05340ff794ee78aedf33ad1ed7b0">pathList</a>[pathcount].<a class="code" href="structPathDescription__TAG.html#a2668a5a6a0c25f1adf05f39f2090e52e">dy</a>;
                dx = <a class="code" href="sgm_8c.html#aa42d05340ff794ee78aedf33ad1ed7b0">pathList</a>[pathcount].<a class="code" href="structPathDescription__TAG.html#a5e58c7cb6a24e560c7be000d359fe0b8">dx</a>;
                <span class="keywordtype">int</span> isVertical = <a class="code" href="sgm_8c.html#aa42d05340ff794ee78aedf33ad1ed7b0">pathList</a>[pathcount].<a class="code" href="structPathDescription__TAG.html#a28cadf9b99f9a5d524a3dc036c1ed3ec">isVertical</a>;
<span class="preprocessor">#ifdef TRACE</span>
<span class="preprocessor"></span>                printf(<span class="stringliteral">&quot;Path Group %d [%d;%d]\n&quot;</span>, pathcount, dy, dx);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
                <span class="keywordtype">int</span> startx = 0;
                <span class="keywordtype">int</span> starty = 0;
                <span class="keywordflow">if</span> (isVertical)
                {
                        <span class="keywordflow">if</span> (dy &lt; 0) starty = I-&gt;h - 1;
                }
                <span class="keywordflow">else</span>
                {
                        <span class="keywordflow">if</span> (dx &lt; 0) startx = I-&gt;w - 1;
                }

                <span class="keywordflow">if</span> (callback != NULL)
                        callback(pathcount, 0);
                <span class="comment">// For every path in the group</span>
                <span class="keywordflow">while</span> (1)
                {
                        x = startx;
                        y = starty;

                        min = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                        <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++)
                        {
                                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> result = Carray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(x,y,d)];
                                <span class="keywordflow">if</span> (result &lt; min)
                                        min = result;
                                Lcost[d] = result;
                                Lcost1[d] = 0;
                        }

                        costs = Lcost;
                        costs1 = Lcost1;
                        oldmin = min;

                        <span class="keywordflow">while</span> (x &lt; I-&gt;w &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; I-&gt;h &amp;&amp; y &gt;= 0)
                        {

                                min = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                                <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++)
                                {
                                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> cost = Carray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(x,y,d)];
                                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> l1 = (d &gt; 0        ? (costs[d - 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>);
                                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> l2 = (d &lt; dMax - 1 ? (costs[d + 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>);
                                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> l3 = oldmin + longPenalty;
                                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> l4 = costs[d];
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> sum =  cost + <a class="code" href="sgm_8c.html#a8f1f85529e4e49f856bf5dbc13f65ddb" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4</a> (l1, l2, l3, l4);
                                        <span class="keywordflow">if</span> (sum &lt; cost || sum &lt; <a class="code" href="sgm_8c.html#a8f1f85529e4e49f856bf5dbc13f65ddb" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4</a> (l1, l2, l3, l4))
                                                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;TROUBLE: OVERFLOW IN SGM&quot;</span>);

                                        <span class="keywordflow">if</span> (oldmin &gt; sum )
                                                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;TROUBLE: INTERNAL BUG IN SGM&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> result =
                                                cost + <a class="code" href="sgm_8c.html#a8f1f85529e4e49f856bf5dbc13f65ddb" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4</a> (l1, l2, l3, l4) - oldmin;

                                        <span class="keywordflow">if</span> (result &lt; min) {
                                                min = result;
                                        }
                                        costs1[d] = result;
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                        sum = Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(x,y,d)] + result;
                                        <span class="keywordflow">if</span> (sum &lt; Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(x,y,d)] || sum &lt; result)
                                                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;TROUBLE: OVERFLOW IN SGM&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                                        <span class="keywordflow">if</span> (pArrayTest != NULL) {
                                                Parray[(<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(x,y,d)) * PATH_LIMIT + pathcount] = result;
                                        }
                                        Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(x,y,d)] += result;
                                        <span class="comment">//Sarray[ADDR(x,y,d)]++;</span>
                                }

                                oldmin = min;
                                tmp = costs;
                                costs = costs1;
                                costs1 = tmp;
                                x += dx;
                                y += dy;
                        }

                        <span class="keywordflow">if</span> (isVertical)
                        {
                                startx++;
                                <span class="keywordflow">if</span> (startx &gt;=  I-&gt;w) {
                                        <span class="keywordflow">break</span>;
                                }
                        }
                        <span class="keywordflow">else</span>
                        {
                                starty++;
                                <span class="keywordflow">if</span> (starty &gt;=  I-&gt;h) {
                                        <span class="keywordflow">break</span>;
                                }
                        }

                }
        }
<span class="preprocessor">#ifdef TRACE</span>
<span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;Arrays done %d\n&quot;</span>, Sarray[56]);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> globalMax = 0;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
        G12Buffer *toReturn = g12BufferCreate(I-&gt;h, I-&gt;w);

        <span class="keywordflow">for</span> (i = 0; i &lt; I-&gt;h; i++ )
        {
                <span class="keywordflow">for</span> (j = 0; j &lt; I-&gt;w; j++ )
                {
                        <span class="keywordtype">double</span> min = 2 * (double)<a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                        <span class="keywordtype">double</span> minpos = -1;
                        <span class="keywordtype">double</span> pos;
                        <span class="keywordflow">for</span> (d = 1; d &lt; dMax - 1; d++)
                        {
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> ((<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>)Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(j,i,d)] &gt;= (1 &lt;&lt; 16))
                                {
                                        <span class="keywordtype">char</span> s[100];
                                        snprintf(s, 100, <span class="stringliteral">&quot;Overflow of 2^16 in SGM global cost buffer at (%d,%d) disp = %d value=%u&quot;</span>, j, i, d, (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>)Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(j,i,d)] );
                                        <span class="keywordtype">int</span> p;
<span class="comment">/*                                        for (p = 0; p &lt; PATH_LIMIT; p++)</span>
<span class="comment">                                                printf( &quot;Path %d cost: %d\n&quot;, p, Parray[(ADDR(j,i,d)) * PATH_LIMIT + p]);*/</span>
                                        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, s);
                                        <span class="comment">//DOASSERT(s);</span>

                                }

<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

<span class="comment">//#define SIMPLE_DIST</span>
<span class="preprocessor">#ifdef SIMPLE_DIST</span>
<span class="preprocessor"></span>                                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> result = Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(j,i,d)];
                                <span class="keywordflow">if</span> (result &lt; min)
                                {
                                        min = result;
                                        minpos = d;
                                }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>                                <span class="comment">// Parbolic Interpolation</span>
                                <span class="keywordtype">int</span> E = Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(j,i,d - 1)];
                                <span class="keywordtype">int</span> F = Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(j,i,d)];
                                <span class="keywordtype">int</span> G = Sarray[<a class="code" href="sgm_8c.html#a2b55a6d36cbcef8fa0391c70aba583e7">ADDR</a>(j,i,d + 1)];

                                <span class="keywordtype">double</span> c = F;
                                <span class="keywordtype">double</span> a = (E + G - 2 * F) / 2;
                                <span class="keywordtype">double</span> b = (G - E) / 2;
                                <span class="keywordtype">double</span> result;

                                <span class="comment">// Parabola goes down. minimum is on the ends</span>
                                <span class="keywordflow">do</span> {
                                        <span class="keywordflow">if</span> (a &gt; 0) {
                                                pos = - b / (2 * a);
                                                <span class="keywordflow">if</span> ( pos &gt;= -1 &amp;&amp; pos &lt;= 1) {
                                                        result = a * pos * pos + b * pos + c;
                                                        pos += d;
                                                        <span class="keywordflow">break</span>;
                                                }
                                        }

                                        <span class="keywordflow">if</span> ( E &gt; G ) {
                                                result = G;
                                                pos = d + 1;
                                        }
                                        <span class="keywordflow">else</span>
                                        {
                                                result = E;
                                                pos = d - 1;
                                        }

                                } <span class="keywordflow">while</span> (0);

                                <span class="keywordflow">if</span> (result &lt; min)
                                {
                                        min = result;
                                        minpos = pos;
                                }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        }
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                        <span class="keywordflow">if</span> (minpos &lt; 0 || minpos &gt; dMax) {
                                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;INTERNAL ERROR&quot;</span>);
                        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
                        toReturn-&gt;data[toReturn-&gt;w * i + j] = ((minpos / dMax) * 255.0) * 16.0;
<span class="comment">//                        toReturn-&gt;data[(toReturn-&gt;w * i + j) * toReturn-&gt;bpp] = ((255.0 / (minpos + 1)));</span>
                }
        }

        <span class="keywordflow">if</span> (cArrayTest != NULL) {
                *cArrayTest = Carray;
        } <span class="keywordflow">else</span> {
                <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Carray);
        }
        <span class="keywordflow">if</span> (sArrayTest != NULL) {
                *sArrayTest = Sarray;
        } <span class="keywordflow">else</span> {
                <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Sarray);
        }
        <span class="keywordflow">if</span> (pArrayTest != NULL) {
                        *pArrayTest = Parray;
        }
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Lcost);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Lcost1);
        <span class="keywordflow">return</span> toReturn;

}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sgm_8h_af70448dac0e19cb4752638e1d4c26927_cgraph.svg" width="382" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1eba02afa0f6055c7630cfc7c102e251"></a><!-- doxytag: member="sgm.h::sgmFastx86" ref="a1eba02afa0f6055c7630cfc7c102e251" args="(G12Buffer *left, G12Buffer *right, int dMax, int closePenlty, int longPenalty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G12Buffer* <a class="el" href="sgm_8h.html#a1eba02afa0f6055c7630cfc7c102e251">sgmFastx86</a> </td>
          <td>(</td>
          <td class="paramtype">G12Buffer *&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G12Buffer *&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>closePenlty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>longPenalty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sgm_8c_source.html#l00498">498</a> of file <a class="el" href="sgm_8c_source.html">sgm.c</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00105">ASSERT_FAIL</a>, <a class="el" href="sgm_8c_source.html#l00064">C()</a>, <a class="el" href="global_8h_source.html#l00153">dv_free</a>, <a class="el" href="global_8h_source.html#l00151">dv_malloc</a>, <a class="el" href="sgm_8c_source.html#l00099">min4_16()</a>, <a class="el" href="stdint__win_8h_source.html#l00127">UINT16_MAX</a>, and <a class="el" href="stdint__win_8h_source.html#l00128">UINT32_MAX</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> (left == NULL || right == NULL)
                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;null parameters not supported&quot;</span>);
        <span class="keywordflow">if</span> (left-&gt;h != right-&gt;h || left-&gt;w != right-&gt;w)
                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Buffers have different sizes&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *Carray;

        <span class="keywordtype">int</span> i,j,d;
        <span class="keywordtype">int</span> h = left-&gt;h;
        <span class="keywordtype">int</span> w = left-&gt;w;
        <span class="keywordtype">int</span> isInverted = dMax &lt; 0;
        dMax = isInverted ? -dMax : dMax;

        <span class="keywordtype">int</span> arraySize = dMax * left-&gt;h * left-&gt;w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>);
        Carray = (<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (arraySize);

        <span class="comment">// Fill the cost array. In fact we don&#39;t need this</span>
        <span class="keywordtype">int</span> offset = 0;
        <span class="keywordflow">if</span> (isInverted)
        {
                <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d ++)
                        <span class="keywordflow">for</span> (i = 0; i &lt; h; i++)
                                <span class="keywordflow">for</span> (j = 0; j &lt; w; j++)
                                        Carray[offset++] = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, j,i, -d ,0);
        }
        <span class="keywordflow">else</span>
        {
                <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d ++)
                        <span class="keywordflow">for</span> (i = 0; i &lt; h; i++)
                                <span class="keywordflow">for</span> (j = 0; j &lt; w; j++)
                                        Carray[offset++] = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left,right, j,i, d ,0);

        }

        <span class="comment">/*Allocate memory for the process*/</span>
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *Sline = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (dMax * w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>));

        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> **(Ltop[3]);
        <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
                Ltop[i] = (<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> **) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *));

        <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
                <span class="keywordflow">for</span> (j = 0; j &lt; w; j++ )
                        Ltop[i][j] = (<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *)<a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (dMax * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>));

        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *(Ltnew[5]);
        <span class="keywordflow">for</span> (i = 0; i &lt; 5; i++)
                Ltnew[i] = (<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (dMax * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>));

        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *(Ltmin[3]);
        <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
        Ltmin[i] = (<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>));

        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *Lleft  = (<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>) * dMax);
        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *Lright = (<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>) * dMax);

        G12Buffer *toReturn = g12BufferCreate(h, w);

        <span class="keywordflow">for</span> (j = 0; j &lt; w ; j++)
        {
                Ltmin[0][j] = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;
                Ltmin[1][j] = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;
                Ltmin[2][j] = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;

                <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++)
                {
                        Ltop[0][j][d] = Carray[d * h * w + 0 * w + j];
                        Ltop[1][j][d] = Carray[d * h * w + 0 * w + j];
                        Ltop[2][j][d] = Carray[d * h * w + 0 * w + j];
                        <span class="keywordflow">if</span> (Ltmin[0][j] &gt; Ltop[0][j][d])
                                Ltmin[0][j] = Ltop[0][j][d];

                        <span class="keywordflow">if</span> (Ltmin[1][j] &gt; Ltop[1][j][d])
                                Ltmin[1][j] = Ltop[1][j][d];

                        <span class="keywordflow">if</span> (Ltmin[2][j] &gt; Ltop[2][j][d])
                                Ltmin[2][j] = Ltop[2][j][d];
                }
        }

        <span class="keywordflow">for</span> (i = 1; i &lt; h; i++)
        {
                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> l1, l2, l3, l4, result;
                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> *tmp;

                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> LleftMin = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;
                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> LrightMin = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;
                <span class="keywordflow">for</span> (j = 0; j &lt; dMax * w; j++)
                        Sline[j] = 0;

                <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++) {
                        Lleft [d] = Carray[d * h * w + i * w + 0];
                        <span class="keywordflow">if</span> (Lleft [d] &lt; LleftMin)
                                LleftMin = Lleft[d];
                        Lright[d] = Carray[d * h * w + i * w + w - 1];
                        <span class="keywordflow">if</span> (Lright [d] &lt; LrightMin)
                                LrightMin = Lright[d];
                }

                <span class="comment">// Fill the line</span>
                <span class="keywordflow">for</span> (j = 1; j &lt; w - 1; j++) {
                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> minTop = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;
                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> minLU = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;
                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> minRU = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;
                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> minL = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;

                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> oldminTop = Ltmin[0][j];
                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> oldminLU  = Ltmin[1][j - 1];
                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> oldminRU  = Ltmin[2][j + 1];

                        <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++) {
                                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> cost = Carray[d * h * w + i * w + j];

                                <span class="comment">// Vertical</span>
                                l1 = (d &gt; 0        ? (Ltop[0][j][d - 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l2 = (d &lt; dMax - 1 ? (Ltop[0][j][d + 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l3 = Ltop[0][j][d];
                                l4 = oldminTop + longPenalty;
                                result =  <a class="code" href="sgm_8c.html#aa9bdc93559872150d5023fdce9bb8c9f" title="This function counts a minimum of the 4 unsigned 16 bit values.">min4_16</a>(l1, l2, l3, l4) - oldminTop + cost;

                                <span class="keywordflow">if</span> (result &lt; minTop) {
                                        minTop = result;
                                }
                                Ltnew[0][d] = result;
                                Sline[j * dMax +  d] += result;
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> (Sline[j * dMax + d] &gt;= (1 &lt;&lt; 16))
                                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Fast SGM overflow1&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

                                <span class="comment">// LU</span>
                                l1 = (d &gt; 0        ? (Ltop[1][j - 1][d - 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l2 = (d &lt; dMax - 1 ? (Ltop[1][j - 1][d + 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l3 = Ltop[1][j - 1][d];
                                l4 = oldminLU + longPenalty;
                                result = <a class="code" href="sgm_8c.html#aa9bdc93559872150d5023fdce9bb8c9f" title="This function counts a minimum of the 4 unsigned 16 bit values.">min4_16</a> (l1, l2, l3, l4) - oldminLU + cost;

                                <span class="keywordflow">if</span> (result &lt; minLU) {
                                        minLU = result;
                                }
                                Ltnew[1][d] = result;
                                Sline[j * dMax +  d] += result;
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> (Sline[j * dMax + d] &gt;= (1 &lt;&lt; 16))
                                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Fast SGM overflow2&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

                                <span class="comment">// RU</span>
                                l1 = (d &gt; 0        ? (Ltop[2][j + 1][d - 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l2 = (d &lt; dMax - 1 ? (Ltop[2][j + 1][d + 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l3 = Ltop[2][j + 1][d];
                                l4 = oldminRU + longPenalty;
                                result = <a class="code" href="sgm_8c.html#aa9bdc93559872150d5023fdce9bb8c9f" title="This function counts a minimum of the 4 unsigned 16 bit values.">min4_16</a> (l1, l2, l3, l4) - oldminRU + cost;

                                <span class="keywordflow">if</span> (result &lt; minRU) {
                                        minRU = result;
                                }
                                Ltnew[2][d] = result;
                                Sline[j * dMax +  d] += result;
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> (Sline[j * dMax + d] &gt;= (1 &lt;&lt; 16))
                                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Fast SGM overflow3&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
                                <span class="comment">// Also From Left</span>
                                l1 = (d &gt; 0        ? (Lleft[d - 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l2 = (d &lt; dMax - 1 ? (Lleft[d + 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l3 = Lleft[d];
                                l4 = LleftMin + longPenalty;
                                result = <a class="code" href="sgm_8c.html#aa9bdc93559872150d5023fdce9bb8c9f" title="This function counts a minimum of the 4 unsigned 16 bit values.">min4_16</a> (l1, l2, l3, l4) - LleftMin + cost;

                                <span class="keywordflow">if</span> (result &lt; minL) {
                                        minL = result;
                                }
                                Ltnew[3][d] = result;
                                Sline[j * dMax +  d] += result;
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> (Sline[j * dMax + d] &gt;= (1 &lt;&lt; 16))
                                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Fast SGM overflow4&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        }

                        tmp = Ltop[0][j];
                        Ltop[0][j] = Ltnew[0];
                        Ltnew[0] = tmp;

                        tmp = Ltop[1][j];
                        Ltop[1][j] = Ltnew[1];
                        Ltnew[1] = tmp;

                        tmp = Ltop[2][j];
                        Ltop[2][j] = Ltnew[2];
                        Ltnew[2] = tmp;

                        tmp = Lleft;
                        Lleft = Ltnew[3];
                        Ltnew[3] = tmp;

                        Ltmin[0][j] = minTop;
                        Ltmin[1][j] = minLU;
                        Ltmin[2][j] = minRU;
                        LleftMin = minL;
                }

                <span class="comment">// Also From Right</span>
                <span class="keywordflow">for</span> (j = w - 1; j &gt;= 1; j--) {
                        <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> minR = <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;

                        <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++) {
                                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> cost = Carray[d * h * w + i * w + j];

                                l1 = (d &gt; 0        ? (Lright[d - 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l2 = (d &lt; dMax - 1 ? (Lright[d + 1] + closePenlty) : <a class="code" href="stdint__win_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);
                                l3 = Lright[d];
                                l4 = LrightMin + longPenalty;
                                result = <a class="code" href="sgm_8c.html#aa9bdc93559872150d5023fdce9bb8c9f" title="This function counts a minimum of the 4 unsigned 16 bit values.">min4_16</a> (l1, l2, l3, l4) - LrightMin + cost;

                                <span class="keywordflow">if</span> (result &lt; minR) {
                                        minR = result;
                                }
                                Ltnew[4][d] = result;
                                Sline[j * dMax +  d] += result;
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> (Sline[j * dMax + d] &gt;= (1 &lt;&lt; 16))
                                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Fast SGM overflow5&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        }
                        tmp = Lright;
                        Lright = Ltnew[4];
                        Ltnew[4] = tmp;
                        LrightMin = minR;
                }



                <span class="keywordflow">for</span> (j = 1; j &lt; w - 1; j++) {
                        <span class="keywordtype">double</span> min = 2 * (double)<a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                        <span class="keywordtype">double</span> minpos = -1;
                        <span class="keywordflow">for</span> (d = 1; d &lt; dMax - 2; d++)
                        {
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> (Sline[j * dMax + d] &gt;= (1 &lt;&lt; 16))
                                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Fast SGM overflow5&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
                                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> result = Sline[j * dMax + d];
                                <span class="keywordflow">if</span> (result &lt; min)
                                {
                                        min = result;
                                        minpos = d;
                                }
                        }
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                        <span class="keywordflow">if</span> (minpos &lt; 0 || minpos &gt; dMax)
                                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;INTERNAL ERROR&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        toReturn-&gt;data[w * i + j] = ((minpos / dMax) * 255.0) * 16.0;
                }


        }

        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Carray);


        <span class="comment">/*Allocate memory for the process*/</span>
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a> (Sline);

        <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
        {
                <span class="keywordflow">for</span> (j = 0; j &lt; w; j++ )
                        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Ltop[i][j]);
                <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Ltop[i]);
        }

        <span class="keywordflow">for</span> (i = 0; i &lt; 5; i++)
                <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Ltnew[i]);

        <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
                <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Ltmin[i]);

        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Lleft);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(Lright);
        <span class="keywordflow">return</span> toReturn;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sgm_8h_a1eba02afa0f6055c7630cfc7c102e251_cgraph.svg" width="235" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a716a595aaf9bcceb6628b980fbbb90ed"></a><!-- doxytag: member="sgm.h::sgmFastx86v1" ref="a716a595aaf9bcceb6628b980fbbb90ed" args="(G12Buffer *left, G12Buffer *right, int dMax, int closePenlty, int longPenalty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G12Buffer* <a class="el" href="sgm_8h.html#a716a595aaf9bcceb6628b980fbbb90ed">sgmFastx86v1</a> </td>
          <td>(</td>
          <td class="paramtype">G12Buffer *&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G12Buffer *&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>closePenlty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>longPenalty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>For a top row compute the lowest cost for all the disparities</p>
<p>Iterate - row by row</p>

<p>Definition at line <a class="el" href="sgm_8c_source.html#l00793">793</a> of file <a class="el" href="sgm_8c_source.html">sgm.c</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00105">ASSERT_FAIL</a>, <a class="el" href="sgm_8c_source.html#l00064">C()</a>, <a class="el" href="global_8h_source.html#l00153">dv_free</a>, <a class="el" href="global_8h_source.html#l00151">dv_malloc</a>, <a class="el" href="sgm_8c_source.html#l00131">min3_32()</a>, <a class="el" href="sgm_8c_source.html#l00109">min4_32()</a>, <a class="el" href="sgm_8c_source.html#l00119">min4_32_special()</a>, and <a class="el" href="stdint__win_8h_source.html#l00128">UINT32_MAX</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> (left == NULL || right == NULL)
                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;null parameters not supported&quot;</span>);
        <span class="keywordflow">if</span> (left-&gt;h != right-&gt;h || left-&gt;w != right-&gt;w)
                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Buffers have different sizes&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
           <span class="keywordtype">int</span> i,j,d;
        <span class="keywordtype">int</span> h = left-&gt;h;
        <span class="keywordtype">int</span> w = left-&gt;w;
        <span class="keywordtype">int</span> isInverted = dMax &lt; 0;
        dMax = isInverted ? -dMax : dMax;

        <span class="comment">/*Allocate memory for the process*/</span>
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *SLine = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (dMax * w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>));

        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopBlock;
        LTopBlock = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (3 * dMax * w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>));
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **LTopPointersBlock;
        LTopPointersBlock = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (3 * w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *));

        <span class="keywordtype">int</span> p;
        <span class="keywordflow">for</span> (p = 0; p &lt; 3 * w; p++)
                LTopPointersBlock[p] = LTopBlock + dMax * p;


        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **LTopLeft  = LTopPointersBlock;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **LTop      = LTopPointersBlock + w;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> **LTopRight = LTopPointersBlock + w * 2;


        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LNewBlock;
        LNewBlock = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (5 * dMax * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>));
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LNewTop      = LNewBlock;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LNewTopLeft  = LNewBlock + dMax;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LNewTopRight = LNewBlock + dMax * 2;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LNewLeft     = LNewBlock + dMax * 3;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LNewRight    = LNewBlock + dMax * 4;


        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopMinBlock;
        LTopMinBlock = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a> (3 * w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>));

        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopLeftMin  = LTopMinBlock;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopMin      = LTopMinBlock + w;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopRightMin = LTopMinBlock + 2 * w;


        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LLeftBlock  = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>) * dMax);
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LRightBlock = (<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *) <a class="code" href="global_8h.html#ab61c97956d31fb1b51bfea6441c979f7">dv_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>) * dMax);

        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LLeft  = LLeftBlock;
        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LRight = LRightBlock;

        G12Buffer *toReturn = g12BufferCreate(h, w);
<span class="comment"></span>
<span class="comment">        /**</span>
<span class="comment">         *   For a top row compute the lowest cost for all the disparities</span>
<span class="comment">         **/</span>
        <span class="keywordflow">for</span> (j = 0; j &lt; w ; j++)
        {
                LTopLeftMin[j]  = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                LTopMin[j]      = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                LTopRightMin[j] = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;

                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> min = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> cost;
                <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++)
                {
                        <span class="keywordflow">if</span> (isInverted)
                                cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, j, 0, -d ,0);
                        <span class="keywordflow">else</span>
                                cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left, right, j, 0, d ,0);

                        LTop[j][d] = cost;
                        LTopLeft[j][d] = cost;
                        LTopRight[j][d] = cost;

                        <span class="keywordflow">if</span> (min &gt; cost)
                                min = cost;
                }

                LTopLeftMin[j]  = min;
                LTopMin[j]      = min;
                LTopRightMin[j] = min;
        }

<span class="comment"></span>
<span class="comment">        /**</span>
<span class="comment">         *  Iterate - row by row</span>
<span class="comment">         **/</span>
        <span class="keywordflow">for</span> (i = 1; i &lt; h; i++)
        {
                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> l1, l2, l3, l4, result;
                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *tmp;

                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> LLeftMin = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> LRightMin = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;

                memset(SLine, 0, dMax * w * <span class="keyword">sizeof</span>(<a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>));

                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> cost;


                <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++)
                {
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> tmpLeft;
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> tmpRight;

                        <span class="keywordflow">if</span> (isInverted)
                                tmpLeft = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, 0, i, -d ,0);
                        <span class="keywordflow">else</span>
                                tmpLeft = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left, right, 0, i, d ,0);

                        <span class="keywordflow">if</span> (isInverted)
                                tmpRight = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, w - 1, i, -d ,0);
                        <span class="keywordflow">else</span>
                                tmpRight = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left, right, w - 1, i, d ,0);

                        LLeft [d] = tmpLeft;
                        <span class="keywordflow">if</span> (tmpLeft &lt; LLeftMin) LLeftMin = tmpLeft;

                        LRight[d] = tmpRight;
                        <span class="keywordflow">if</span> (tmpRight &lt; LRightMin) LRightMin = tmpRight;
                }

                <span class="comment">// Fill the line</span>
                <span class="keywordflow">for</span> (j = 1; j &lt; w - 1; j++) {
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> minTop      = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> minTopLeft  = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> minTopRight = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> minLeft     = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;

                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> oldMinTop      = LTopMin[j];
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> oldMinTopLeft  = LTopLeftMin[j - 1];
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> oldMinTopRight  = LTopRightMin[j + 1];
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> cost;
                        <span class="comment">//uint32_t *costOffset = Carray + i * w * dMax + j * dMax;</span>

                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopLine = LTop[j];
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopRightLine = LTopRight[j + 1];
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> *LTopLeftLine = LTopLeft[j - 1];


                        <span class="comment">/* d = 0 */</span>
                        <span class="comment">//cost = *costOffset;</span>
                        <span class="keywordflow">if</span> (isInverted)
                                cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, j,i, 0 ,0);
                        <span class="keywordflow">else</span>
                                cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left, right, j,i, 0 ,0);
                        <span class="comment">//costOffset++;</span>

                        <span class="comment">// Vertical</span>
                        l2 = LTopLine[1] + closePenalty;
                        l3 = LTopLine[0];
                        l4 = oldMinTop + longPenalty;
                        result =  <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a>(l2, l3, l4) - oldMinTop + cost;
                        <span class="keywordflow">if</span> (result &lt; minTop) minTop = result;
                        LNewTop[0] = result;
                        SLine[j * dMax] += result;

                        <span class="comment">// Left-Top direction</span>
                        l2 = LTopLeftLine[1] + closePenalty;
                        l3 = LTopLeftLine[0];
                        l4 = oldMinTopLeft + longPenalty;
                        result = <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a> (l2, l3, l4) - oldMinTopLeft + cost;
                        <span class="keywordflow">if</span> (result &lt; minTopLeft) minTopLeft = result;
                        LNewTopLeft[0] = result;
                        SLine[j * dMax] += result;

                        <span class="comment">// Right-Top direction</span>
                        l2 = LTopRightLine[1] + closePenalty;
                        l3 = LTopRightLine[0];
                        l4 = oldMinTopRight + longPenalty;
                        result = <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a> (l2, l3, l4) - oldMinTopRight + cost;
                        <span class="keywordflow">if</span> (result &lt; minTopRight) minTopRight = result;
                        LNewTopRight[0] = result;
                        SLine[j * dMax] += result;

                        <span class="comment">// Also From Left</span>
                        l2 = LLeft[1] + closePenalty;
                        l3 = LLeft[0];
                        l4 = LLeftMin + longPenalty;
                        result = <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a> (l2, l3, l4) - LLeftMin + cost;
                        <span class="keywordflow">if</span> (result &lt; minLeft) minLeft = result;
                        LNewLeft[0] = result;
                        SLine[j * dMax ] += result;

                        <span class="comment">/* Conventional d*/</span>

                        <span class="keywordflow">for</span> (d = 1; d &lt; dMax - 1; d++)
                        {
                                <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> addition = 0;
                                <span class="comment">//cost = *costOffset;</span>
                                <span class="comment">//costOffset++;</span>
                                <span class="keywordflow">if</span> (isInverted)
                                        cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, j,i, -d ,0);
                                <span class="keywordflow">else</span>
                                        cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left, right, j,i, d ,0);

                                <span class="comment">// Vertical</span>
                                l1 = LTopLine[d - 1];
                                l2 = LTopLine[d + 1];
                                l3 = LTopLine[d];
                                l4 = oldMinTop + longPenalty;
                                result =  <a class="code" href="sgm_8c.html#a910aee1a4ddefcd05cbb4f2a86d542e3" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4_32_special</a>(l1, l2, l3, l4, closePenalty) - oldMinTop + cost;
                                <span class="keywordflow">if</span> (result &lt; minTop) minTop = result;
                                LNewTop[d] = result;
                                addition += result;
                                <span class="comment">// Left-Top direction</span>

                                l1 = LTopLeftLine[d - 1];
                                l2 = LTopLeftLine[d + 1];
                                l3 = LTopLeftLine[d];
                                l4 = oldMinTopLeft + longPenalty;
                                result = <a class="code" href="sgm_8c.html#a910aee1a4ddefcd05cbb4f2a86d542e3" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4_32_special</a>(l1, l2, l3, l4, closePenalty) - oldMinTopLeft + cost;
                                <span class="keywordflow">if</span> (result &lt; minTopLeft) minTopLeft = result;
                                LNewTopLeft[d] = result;
                                addition  += result;

                                <span class="comment">// Right-Top direction</span>
                                l1 = LTopRightLine[d - 1];
                                l2 = LTopRightLine[d + 1];
                                l3 = LTopRightLine[d];
                                l4 = oldMinTopRight + longPenalty;
                                result = <a class="code" href="sgm_8c.html#a910aee1a4ddefcd05cbb4f2a86d542e3" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4_32_special</a>(l1, l2, l3, l4, closePenalty) - oldMinTopRight + cost;
                                <span class="keywordflow">if</span> (result &lt; minTopRight) minTopRight = result;
                                LNewTopRight[d] = result;
                                addition  += result;

                                <span class="comment">// Also From Left</span>
                                l1 = LLeft[d - 1];
                                l2 = LLeft[d + 1];
                                l3 = LLeft[d];
                                l4 = LLeftMin + longPenalty;
                                result = <a class="code" href="sgm_8c.html#a910aee1a4ddefcd05cbb4f2a86d542e3" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4_32_special</a>(l1, l2, l3, l4, closePenalty) - LLeftMin + cost;
                                <span class="keywordflow">if</span> (result &lt; minLeft) minLeft = result;
                                LNewLeft[d] = result;
                                addition += result;

                                SLine[j * dMax +  d] += addition;
                        }

                        d = dMax - 1;
                        <span class="comment">//cost = *costOffset;</span>
                        <span class="comment">//costOffset++;</span>
                        <span class="keywordflow">if</span> (isInverted)
                                cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, j,i, -d ,0);
                        <span class="keywordflow">else</span>
                                cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left, right, j,i, d ,0);


                        <span class="comment">// Vertical</span>
                        l1 = LTopLine[d - 1] + closePenalty;
                        l3 = LTopLine[d];
                        l4 = oldMinTop + longPenalty;
                        result =  <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a>(l1, l3, l4) - oldMinTop + cost;
                        <span class="keywordflow">if</span> (result &lt; minTop) minTop = result;
                        LNewTop[d] = result;
                        SLine[j * dMax +  d] += result;

                        <span class="comment">// Left-Top direction</span>

                        l1 = LTopLeftLine[d - 1] + closePenalty;
                        l3 = LTopLeftLine[d];
                        l4 = oldMinTopLeft + longPenalty;
                        result = <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a> (l1, l3, l4) - oldMinTopLeft + cost;

                        <span class="keywordflow">if</span> (result &lt; minTopLeft) {
                                minTopLeft = result;
                        }
                        LNewTopLeft[d] = result;
                        SLine[j * dMax +  d] += result;

                        <span class="comment">// Right-Top direction</span>
                        l1 = LTopRightLine[d - 1] + closePenalty;
                        l3 = LTopRightLine[d];
                        l4 = oldMinTopRight + longPenalty;
                        result = <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a> (l1, l3, l4) - oldMinTopRight + cost;
                        <span class="keywordflow">if</span> (result &lt; minTopRight) minTopRight = result;
                        LNewTopRight[d] = result;
                        SLine[j * dMax +  d] += result;

                        <span class="comment">// Also From Left</span>
                        l1 = LLeft[d - 1] + closePenalty;
                        l3 = LLeft[d];
                        l4 = LLeftMin + longPenalty;
                        result = <a class="code" href="sgm_8c.html#a5929f9b15aca82940658f3c80ca83938" title="This function counts a minimum of the 4 unsigned 32 bit values.">min3_32</a> (l1, l3, l4) - LLeftMin + cost;
                        <span class="keywordflow">if</span> (result &lt; minLeft) minLeft = result;
                        LNewLeft[d] = result;
                        SLine[j * dMax +  d] += result;

                        tmp = LTop[j];
                        LTop[j] = LNewTop;
                        LNewTop = tmp;

                        tmp = LTopLeft[j];
                        LTopLeft[j] = LNewTopLeft;
                        LNewTopLeft = tmp;

                        tmp = LTopRight[j];
                        LTopRight[j] = LNewTopRight;
                        LNewTopRight = tmp;

                        tmp = LLeft;
                        LLeft = LNewLeft;
                        LNewLeft = tmp;

                        LTopMin[j] = minTop;
                        LTopLeftMin[j] = minTopLeft;
                        LTopRightMin[j] = minTopRight;
                        LLeftMin = minLeft;
                }

                <span class="comment">// Also From Right</span>
                <span class="keywordflow">for</span> (j = w - 1; j &gt;= 1; j--) {
                        <a class="code" href="stdint__win_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> minRight = <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;

                        <span class="keywordflow">for</span> (d = 0; d &lt; dMax; d++) {
                                <span class="keywordflow">if</span> (isInverted)
                                        cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(right, left, j,i, -d ,0);
                                <span class="keywordflow">else</span>
                                        cost = <a class="code" href="sgm_8c.html#aeb98a786bdab8ea10a70b8f8a3484ff2">C</a>(left, right, j,i, d ,0);

                                l1 = (d &gt; 0        ? (LRight[d - 1] + closePenalty) : <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>);
                                l2 = (d &lt; dMax - 1 ? (LRight[d + 1] + closePenalty) : <a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>);
                                l3 = LRight[d];
                                l4 = LRightMin + longPenalty;
                                result = <a class="code" href="sgm_8c.html#a69802edaa629ca536459289aa03cd03f" title="This function counts a minimum of the 4 unsigned 32 bit values.">min4_32</a> (l1, l2, l3, l4) - LRightMin + cost;

                                <span class="keywordflow">if</span> (result &lt; minRight) {
                                        minRight = result;
                                }
                                LNewRight[d] = result;
                                SLine[j * dMax +  d] += result;
                        }
                        tmp = LRight;
                        LRight = LNewRight;
                        LNewRight = tmp;

                        LRightMin = minRight;
                }



                <span class="keywordflow">for</span> (j = 1; j &lt; w - 1; j++) {
                        <span class="keywordtype">double</span> min = 2 * (double)<a class="code" href="stdint__win_8h.html#ab5eb23180f7cc12b7d6c04a8ec067fdd">UINT32_MAX</a>;
                        <span class="keywordtype">double</span> minpos = -1;
                        <span class="keywordflow">for</span> (d = 1; d &lt; dMax - 2; d++)
                        {
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                                <span class="keywordflow">if</span> (SLine[j * dMax + d] &gt;= (1 &lt;&lt; 16))
                                        <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;Fast SGM overflow5&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
                                <a class="code" href="stdint__win_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> result = SLine[j * dMax + d];
                                <span class="keywordflow">if</span> (result &lt; min)
                                {
                                        min = result;
                                        minpos = d;
                                }
                        }
<span class="preprocessor">#ifdef ASSERTS</span>
<span class="preprocessor"></span>                        <span class="keywordflow">if</span> (minpos &lt; 0 || minpos &gt; dMax)
                                <a class="code" href="global_8h.html#a52f9c107723d7daf1945bafba566ae00">ASSERT_FAIL</a>(<span class="stringliteral">&quot;INTERNAL ERROR&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                        toReturn-&gt;data[w * i + j] = ((minpos / dMax) * 255.0) * 16.0;
                }


        }

        <span class="comment">/*Deallocate memory after the process*/</span>
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(SLine);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(LTopBlock);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(LTopPointersBlock);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(LNewBlock);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(LTopMinBlock);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(LLeftBlock);
        <a class="code" href="global_8h.html#af122ce751a03e5f7b15a5f2a9f622eb4">dv_free</a>(LRightBlock);
        <span class="keywordflow">return</span> toReturn;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sgm_8h_a716a595aaf9bcceb6628b980fbbb90ed_cgraph.svg" width="302" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Nov 12 2013 23:44:40 for DeepView by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
