<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DeepView: core/math/matrix/matrix.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">DeepView
   &#160;<span id="projectnumber">0.02</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">core/math/matrix/matrix.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="matrix_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**</span>
<a name="l00002"></a>00002 <span class="comment"> * \file matrix.cpp</span>
<a name="l00003"></a>00003 <span class="comment"> * \brief Generic dense matrix of the arbitatry size</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * \ingroup cppcorefiles</span>
<a name="l00006"></a>00006 <span class="comment"> * \date Mar 24, 2010</span>
<a name="l00007"></a>00007 <span class="comment"> * \author alexander</span>
<a name="l00008"></a>00008 <span class="comment"> */</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="global_8h.html" title="This file holds the global includes, mostly for debuging, tracing and profiling.">global.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="math_2matrix_2matrix_8h.html">matrix.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="matrix33_8h.html" title="This file holds the header for the commonly used structure - a 3 by 3 matrix.">matrix33.h</a>&quot;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">namespace </span>corecvs {
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="comment">/* The constructor is not in single cycle due to possible stride of the matrix */</span>
<a name="l00018"></a><a class="code" href="classcorecvs_1_1Matrix.html#a28d434fb511995c797e7e92c545dfc3e">00018</a> <a class="code" href="classcorecvs_1_1Matrix.html#a3b47c6379c952f4bb360a4a08bc3f68f" title="This function creates a matrix with all zero elements.">Matrix::Matrix</a>(<a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a> &amp;<a class="code" href="structin.html">in</a>) : <a class="code" href="classcorecvs_1_1AbstractBuffer.html">MatrixBase</a>(3, 3, false)
<a name="l00019"></a>00019 {
<a name="l00020"></a>00020     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,0) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(0,0);
<a name="l00021"></a>00021     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,1) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(0,1);
<a name="l00022"></a>00022     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,2) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(0,2);
<a name="l00023"></a>00023 
<a name="l00024"></a>00024     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(1,0) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(1,0);
<a name="l00025"></a>00025     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(1,1) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(1,1);
<a name="l00026"></a>00026     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(1,2) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(1,2);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(2,0) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(2,0);
<a name="l00029"></a>00029     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(2,1) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(2,1);
<a name="l00030"></a>00030     <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(2,2) = in.<a class="code" href="classcorecvs_1_1Matrix33.html#a8596ffc77b92da2876c22900c02e9bec" title="Geting Matrix element functions block.">a</a>(2,2);
<a name="l00031"></a>00031 }
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="comment">/* TODO: Make this inline */</span>
<a name="l00034"></a><a class="code" href="classcorecvs_1_1Matrix.html#a79f61a0031b50cac9f2820494fb55013">00034</a> <a class="code" href="classcorecvs_1_1Matrix.html#a3b47c6379c952f4bb360a4a08bc3f68f" title="This function creates a matrix with all zero elements.">Matrix::Matrix</a>(<a class="code" href="classcorecvs_1_1Matrix44.html" title="This class is mostly for representing Projectrive Transformations in 3D.">Matrix44</a> &amp;<a class="code" href="structin.html">in</a>) : <a class="code" href="classcorecvs_1_1AbstractBuffer.html">MatrixBase</a>(4, 4, false)
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; in.<a class="code" href="classcorecvs_1_1Matrix44.html#a723ca4b9ae734f6466ea55662d8cdd4d">H</a>; i++)
<a name="l00037"></a>00037         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; in.<a class="code" href="classcorecvs_1_1Matrix44.html#a212ee6b8de9b4a5a5500b9af6b2487a8">W</a>; j++)
<a name="l00038"></a>00038         {
<a name="l00039"></a>00039             <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,j) = in.<a class="code" href="classcorecvs_1_1Matrix44.html#ad53e6a4c5f30ed13b1bd0946f0e66a06" title="Geting Matrix element functions block.">a</a>(i,j);
<a name="l00040"></a>00040         }
<a name="l00041"></a>00041 }
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="classcorecvs_1_1Matrix.html#ad1921c3513f67cc61872cfe37ad9be52">00043</a> <a class="code" href="classcorecvs_1_1Matrix.html#a3b47c6379c952f4bb360a4a08bc3f68f" title="This function creates a matrix with all zero elements.">Matrix::Matrix</a>(<a class="code" href="stdint__win_8h.html#a37994e3b11c72957c6f454c6ec96d43d">int32_t</a> h, <a class="code" href="stdint__win_8h.html#a37994e3b11c72957c6f454c6ec96d43d">int32_t</a> w, <span class="keywordtype">double</span> value) : <a class="code" href="classcorecvs_1_1AbstractBuffer.html">MatrixBase</a>(h, w, (double)(0.0))
<a name="l00044"></a>00044 {
<a name="l00045"></a>00045     <a class="code" href="stdint__win_8h.html#a37994e3b11c72957c6f454c6ec96d43d">int32_t</a> minDim = min(h,w);
<a name="l00046"></a>00046     <span class="keywordflow">for</span> (<a class="code" href="stdint__win_8h.html#a37994e3b11c72957c6f454c6ec96d43d">int32_t</a> i = 0; i &lt; minDim; i++)
<a name="l00047"></a>00047         <a class="code" href="classcorecvs_1_1AbstractBuffer.html#a98f72526738a0c4ce8a0b72a3b5c28b9" title="The element getter.">MatrixBase::element</a>(i,i) = value;
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classcorecvs_1_1Matrix.html#adf217ece20bc02b343e37261cbac44ef">00050</a> <a class="code" href="classcorecvs_1_1Matrix.html#a3b47c6379c952f4bb360a4a08bc3f68f" title="This function creates a matrix with all zero elements.">Matrix::Matrix</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1DiagonalMatrix.html" title="This class stores square diagonal matrix.">DiagonalMatrix</a> &amp;that) : <a class="code" href="classcorecvs_1_1AbstractBuffer.html">MatrixBase</a>(that.size(), that.size())
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; that.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#abea4ed304b5caa5355e5707cbe408468">size</a>(); i++)
<a name="l00053"></a>00053         this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,i) = that.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#ad7c89ede3622a41e4dfd179cf499f205">at</a>(i);
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">/*Matrix::Matrix(int32_t h, int32_t w, std::vector&lt;double&gt; &amp;data) : CMatrixBase(h, w, (double)(0.0))</span>
<a name="l00057"></a>00057 <span class="comment">{</span>
<a name="l00058"></a>00058 <span class="comment">    int size = data.size()</span>
<a name="l00059"></a>00059 <span class="comment">    for (unsigned i = 0; i &lt; data.size(); i++)</span>
<a name="l00060"></a>00060 <span class="comment">        this-&gt;data[i] = data[i];</span>
<a name="l00061"></a>00061 <span class="comment">}*/</span>
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classcorecvs_1_1Matrix.html#aa968d38918dffa20417bd53b3d8e0c68">00063</a> <a class="code" href="classcorecvs_1_1Matrix.html#aa968d38918dffa20417bd53b3d8e0c68">Matrix::operator Matrix33</a>()<span class="keyword"> const</span>
<a name="l00064"></a>00064 <span class="keyword"></span>{
<a name="l00065"></a>00065     <span class="keywordflow">return</span> <a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a> (
<a name="l00066"></a>00066      <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,0), <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,1), <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,2),
<a name="l00067"></a>00067      <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(1,0), <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(1,1), <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(1,2),
<a name="l00068"></a>00068      <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(2,0), <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(2,1), <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(2,2)
<a name="l00069"></a>00069     );
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="comment">/* TODO: Merge functions below */</span>
<a name="l00073"></a><a class="code" href="classcorecvs_1_1Matrix.html#a0603004ed83b589dc996c68e6d1003d2">00073</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *<a class="code" href="classcorecvs_1_1Matrix.html#a0603004ed83b589dc996c68e6d1003d2" title="Matrix multiplication.">Matrix::mul</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a>&amp; V)
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a> (this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == V.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, <span class="stringliteral">&quot;Matrices have wrong sizes&quot;</span>);
<a name="l00076"></a>00076     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *result = <span class="keyword">new</span> <a class="code" href="classcorecvs_1_1Matrix.html#a3b47c6379c952f4bb360a4a08bc3f68f" title="This function creates a matrix with all zero elements.">Matrix</a>(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, V.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="keyword">false</span>);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keywordtype">int</span> row, column, runner;
<a name="l00079"></a>00079     <span class="keywordflow">for</span> (row = 0; row &lt; result-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00080"></a>00080         <span class="keywordflow">for</span> (column = 0; column &lt; result-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00081"></a>00081         {
<a name="l00082"></a>00082             <span class="keywordtype">double</span> sum = 0;
<a name="l00083"></a>00083             <span class="keywordflow">for</span> (runner = 0; runner &lt; this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>; runner++)
<a name="l00084"></a>00084             {
<a name="l00085"></a>00085                 sum += this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, runner) * V.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(runner, column);
<a name="l00086"></a>00086             }
<a name="l00087"></a>00087             result-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) = sum;
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="keywordflow">return</span> result;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="namespacecorecvs.html#a1b9367bafe9405a7c306b9bbc479b831">00094</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespacecorecvs.html#aefcd1d1c9d4d3e7492d4dba9e4d8fbb2">operator *</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;B)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a> (A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == B.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, <span class="stringliteral">&quot;Matrices have wrong sizes&quot;</span>);
<a name="l00097"></a>00097     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, B.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="keyword">false</span>);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="keywordtype">int</span> row, column, runner;
<a name="l00100"></a>00100     <span class="keywordflow">for</span> (row = 0; row &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00101"></a>00101         <span class="keywordflow">for</span> (column = 0; column &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00102"></a>00102         {
<a name="l00103"></a>00103             <span class="keywordtype">double</span> sum = 0;
<a name="l00104"></a>00104             <span class="keywordflow">for</span> (runner = 0; runner &lt; A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>; runner++)
<a name="l00105"></a>00105             {
<a name="l00106"></a>00106                 sum += A.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, runner) * B.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(runner, column);
<a name="l00107"></a>00107             }
<a name="l00108"></a>00108             result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) = sum;
<a name="l00109"></a>00109         }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <span class="keywordflow">return</span> result;
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a><a class="code" href="namespacecorecvs.html#ad7fd7a003c6be73d91f4b75555f9a244">00115</a> <a class="code" href="classcorecvs_1_1FixedArray.html">Vector</a> <a class="code" href="namespacecorecvs.html#aefcd1d1c9d4d3e7492d4dba9e4d8fbb2">operator *</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;M, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1FixedArray.html">Vector</a> &amp;V)
<a name="l00116"></a>00116 {
<a name="l00117"></a>00117     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a> (M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == V.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#abea4ed304b5caa5355e5707cbe408468">size</a>(), <span class="stringliteral">&quot;Matrix and vector have wrong sizes&quot;</span>);
<a name="l00118"></a>00118     <a class="code" href="classcorecvs_1_1FixedArray.html">Vector</a> result(M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>);
<a name="l00119"></a>00119     <span class="keywordtype">int</span> row, column;
<a name="l00120"></a>00120     <span class="keywordflow">for</span> (row = 0; row &lt; M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>; row++)
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122         <span class="keywordtype">double</span> sum = 0.0;
<a name="l00123"></a>00123         <span class="keywordflow">for</span> (column = 0; column &lt; M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00124"></a>00124         {
<a name="l00125"></a>00125             sum += V.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#ad7c89ede3622a41e4dfd179cf499f205">at</a>(column) * M.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127         result.at(row) = sum;
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129     <span class="keywordflow">return</span> result;
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="namespacecorecvs.html#a592c2858f841f2cfb5e20cd40e25ec18">00132</a> <a class="code" href="classcorecvs_1_1FixedArray.html">Vector</a> <a class="code" href="namespacecorecvs.html#aefcd1d1c9d4d3e7492d4dba9e4d8fbb2">operator *</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1FixedArray.html">Vector</a> &amp;V, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;M)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a> (M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> == V.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#abea4ed304b5caa5355e5707cbe408468">size</a>(), <span class="stringliteral">&quot;Matrix and vector have wrong sizes&quot;</span>);
<a name="l00135"></a>00135     <a class="code" href="classcorecvs_1_1FixedArray.html">Vector</a> result(M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>);
<a name="l00136"></a>00136     <span class="keywordtype">int</span> row, column;
<a name="l00137"></a>00137     <span class="keywordflow">for</span> (column = 0; column &lt; M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00138"></a>00138     {
<a name="l00139"></a>00139         <span class="keywordtype">double</span> sum = 0.0;
<a name="l00140"></a>00140         <span class="keywordflow">for</span> (row = 0; row &lt; M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>; row++)
<a name="l00141"></a>00141         {
<a name="l00142"></a>00142             sum += V.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#ad7c89ede3622a41e4dfd179cf499f205">at</a>(row) * M.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00143"></a>00143         }
<a name="l00144"></a>00144         result.at(column) = sum;
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146     <span class="keywordflow">return</span> result;
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="namespacecorecvs.html#a0fbe37c9b4dd598069a98a68ec9d7e25">00150</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespacecorecvs.html#a727d1a3a48a18469b61241a1294cb38a">operator *=</a>(<a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;M, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1DiagonalMatrix.html" title="This class stores square diagonal matrix.">DiagonalMatrix</a> &amp;D)
<a name="l00151"></a>00151 {
<a name="l00152"></a>00152     <a class="code" href="stdint__win_8h.html#a37994e3b11c72957c6f454c6ec96d43d">int32_t</a> minDim = min(M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>,M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>);
<a name="l00153"></a>00153     minDim = min(minDim, D.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#abea4ed304b5caa5355e5707cbe408468">size</a>());
<a name="l00154"></a>00154     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; minDim ; i++)
<a name="l00155"></a>00155     {
<a name="l00156"></a>00156          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; minDim ; j++)
<a name="l00157"></a>00157          {
<a name="l00158"></a>00158             M.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,j) *= D.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#ad7c89ede3622a41e4dfd179cf499f205">at</a>(i);
<a name="l00159"></a>00159          }
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161     <span class="keywordflow">return</span> M;
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 
<a name="l00164"></a><a class="code" href="namespacecorecvs.html#a192339d3d05978394d8706491f5630c2">00164</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespacecorecvs.html#aefcd1d1c9d4d3e7492d4dba9e4d8fbb2">operator *</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;M, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1DiagonalMatrix.html" title="This class stores square diagonal matrix.">DiagonalMatrix</a> &amp;D)
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166     <a class="code" href="stdint__win_8h.html#a37994e3b11c72957c6f454c6ec96d43d">int32_t</a> minDim = min(M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>,M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>);
<a name="l00167"></a>00167     minDim = min(minDim, D.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#abea4ed304b5caa5355e5707cbe408468">size</a>());
<a name="l00168"></a>00168     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(minDim, minDim, <span class="keyword">false</span>);
<a name="l00169"></a>00169     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; minDim ; i++)
<a name="l00170"></a>00170     {
<a name="l00171"></a>00171          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; minDim ; j++)
<a name="l00172"></a>00172          {
<a name="l00173"></a>00173              result.a(i,j) = M.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,j) * D.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#ad7c89ede3622a41e4dfd179cf499f205">at</a>(i);
<a name="l00174"></a>00174          }
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176     <span class="keywordflow">return</span> result;
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="namespacecorecvs.html#a08b9473eb552518bd134e94bb1aac86f">00179</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespacecorecvs.html#aefcd1d1c9d4d3e7492d4dba9e4d8fbb2">operator *</a>(<a class="code" href="classcorecvs_1_1DiagonalMatrix.html" title="This class stores square diagonal matrix.">DiagonalMatrix</a> &amp;D, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;M)
<a name="l00180"></a>00180 {
<a name="l00181"></a>00181     <a class="code" href="stdint__win_8h.html#a37994e3b11c72957c6f454c6ec96d43d">int32_t</a> minDim = min(M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>,M.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>);
<a name="l00182"></a>00182     minDim = min(minDim, D.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#abea4ed304b5caa5355e5707cbe408468">size</a>());
<a name="l00183"></a>00183     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(minDim, minDim, <span class="keyword">false</span>);
<a name="l00184"></a>00184     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; minDim ; i++)
<a name="l00185"></a>00185     {
<a name="l00186"></a>00186         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; minDim ; j++)
<a name="l00187"></a>00187         {
<a name="l00188"></a>00188             result.a(i,j) = M.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,j) * D.<a class="code" href="classcorecvs_1_1FixedArrayBase.html#ad7c89ede3622a41e4dfd179cf499f205">at</a>(j);
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191     <span class="keywordflow">return</span> result;
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="comment">/* TODO: Use abstract buffer binaryOperation elementWize */</span>
<a name="l00196"></a><a class="code" href="namespacecorecvs.html#a0230738a50668a44c0bce2971830a37e">00196</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespacecorecvs.html#a0b93f26fd38d9fbb1262817285fbb5b2">operator +</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;B)
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a> (A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == B.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> &amp;&amp; A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> == B.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, <span class="stringliteral">&quot;Matrices have wrong sizes&quot;</span>);
<a name="l00199"></a>00199     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="keyword">false</span>);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> column = 0; column &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00204"></a>00204         {
<a name="l00205"></a>00205             result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) = A.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) + B.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="keywordflow">return</span> result;
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 
<a name="l00213"></a><a class="code" href="namespacecorecvs.html#ab2c5e4a1f4974daf48372d80c684643e">00213</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespacecorecvs.html#aabe8b923561797da5d320da0911b9696">operator -</a>(<span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;B)
<a name="l00214"></a>00214 {
<a name="l00215"></a>00215     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a> (A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == B.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> &amp;&amp; A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> == B.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, <span class="stringliteral">&quot;Matrices have wrong sizes&quot;</span>);
<a name="l00216"></a>00216     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, A.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="keyword">false</span>);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00219"></a>00219     {
<a name="l00220"></a>00220         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> column = 0; column &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00221"></a>00221         {
<a name="l00222"></a>00222             result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) = A.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) - B.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225     <span class="keywordflow">return</span> result;
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 
<a name="l00229"></a><a class="code" href="namespacecorecvs.html#ace234fdda6b75d6d78d1b90c4dd3c967">00229</a> ostream &amp; <a class="code" href="namespacecorecvs.html#ac33e87197ef60769fd586cb7c48a3006">operator &lt;&lt;</a>(ostream &amp;out, <span class="keyword">const</span> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> &amp;matrix)
<a name="l00230"></a>00230 {
<a name="l00231"></a>00231     streamsize wasPrecision = out.precision(6);
<a name="l00232"></a>00232     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; matrix.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>; i++)
<a name="l00233"></a>00233     {
<a name="l00234"></a>00234         out &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;
<a name="l00235"></a>00235         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; matrix.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>; j++)
<a name="l00236"></a>00236         {
<a name="l00237"></a>00237             out.width(9);
<a name="l00238"></a>00238             out &lt;&lt; matrix.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240         out &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242     out.precision(wasPrecision);
<a name="l00243"></a>00243     <span class="keywordflow">return</span> out;
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="comment">/* Merge three functions below*/</span>
<a name="l00248"></a><a class="code" href="classcorecvs_1_1Matrix.html#ac6e32f512abde1198381fca7aaebc24d">00248</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *<a class="code" href="classcorecvs_1_1Matrix.html#ac6e32f512abde1198381fca7aaebc24d" title="Matrix transposition.">Matrix::transposed</a>()<span class="keyword"> const</span>
<a name="l00249"></a>00249 <span class="keyword"></span>{
<a name="l00250"></a>00250     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a>* result = <span class="keyword">new</span> <a class="code" href="classcorecvs_1_1Matrix.html#a3b47c6379c952f4bb360a4a08bc3f68f" title="This function creates a matrix with all zero elements.">Matrix</a>(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, <span class="keyword">false</span>);
<a name="l00251"></a>00251     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; result-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00252"></a>00252     {
<a name="l00253"></a>00253         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> column = 0; column &lt; result-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00254"></a>00254         {
<a name="l00255"></a>00255             result-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column, row) = this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00256"></a>00256         }
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     <span class="keywordflow">return</span> result;
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a><a class="code" href="classcorecvs_1_1Matrix.html#a592174ecffa431b0f6b2a47aeee2ad23">00262</a> <span class="keywordtype">void</span> <a class="code" href="classcorecvs_1_1Matrix.html#a592174ecffa431b0f6b2a47aeee2ad23">Matrix::transpose</a>()
<a name="l00263"></a>00263 {
<a name="l00264"></a>00264     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> == this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="stringliteral">&quot;Matrix should be square to transpose.&quot;</span>);
<a name="l00265"></a>00265 
<a name="l00266"></a>00266     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00267"></a>00267     {
<a name="l00268"></a>00268         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> column = row + 1; column &lt; this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00269"></a>00269         {
<a name="l00270"></a>00270             <span class="keywordtype">double</span> tmp;
<a name="l00271"></a>00271             tmp = this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column, row);
<a name="l00272"></a>00272             this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column, row) = this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00273"></a>00273             this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) = tmp;
<a name="l00274"></a>00274         }
<a name="l00275"></a>00275     }
<a name="l00276"></a>00276 }
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="classcorecvs_1_1Matrix.html#ae23aa5c2e50e7913de6aa4c703d4efa4">00278</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="classcorecvs_1_1Matrix.html#ae23aa5c2e50e7913de6aa4c703d4efa4">Matrix::t</a>()<span class="keyword"> const</span>
<a name="l00279"></a>00279 <span class="keyword"></span>{
<a name="l00280"></a>00280     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, <span class="keyword">false</span>);
<a name="l00281"></a>00281     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00282"></a>00282     {
<a name="l00283"></a>00283         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> column = 0; column &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00284"></a>00284         {
<a name="l00285"></a>00285             result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) = this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column, row);
<a name="l00286"></a>00286         }
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289     <span class="keywordflow">return</span> result;
<a name="l00290"></a>00290 }
<a name="l00291"></a>00291 
<a name="l00292"></a><a class="code" href="classcorecvs_1_1Matrix.html#a856596a1a2dacbf97b171ff66aa0da4b">00292</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="classcorecvs_1_1Matrix.html#a856596a1a2dacbf97b171ff66aa0da4b">Matrix::negative</a>()<span class="keyword"> const</span>
<a name="l00293"></a>00293 <span class="keyword"></span>{
<a name="l00294"></a>00294    <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, <span class="keyword">false</span>);
<a name="l00295"></a>00295    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00296"></a>00296    {
<a name="l00297"></a>00297        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> column = 0; column &lt; result.<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00298"></a>00298        {
<a name="l00299"></a>00299            result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column) = -this-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00300"></a>00300        }
<a name="l00301"></a>00301    }
<a name="l00302"></a>00302    <span class="keywordflow">return</span> result;
<a name="l00303"></a>00303 }
<a name="l00304"></a>00304 
<a name="l00305"></a><a class="code" href="classcorecvs_1_1Matrix.html#a77d0ebee160d462227e53e4642797ea1">00305</a> <span class="keywordtype">double</span> <a class="code" href="classcorecvs_1_1Matrix.html#a77d0ebee160d462227e53e4642797ea1">Matrix::trace</a>()<span class="keyword"> const</span>
<a name="l00306"></a>00306 <span class="keyword"></span>{
<a name="l00307"></a>00307     <span class="keywordtype">int</span> minDim = <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> &lt; <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ? <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> : <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>;
<a name="l00308"></a>00308     <span class="keywordtype">double</span> sum = 0.0;
<a name="l00309"></a>00309     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; minDim; i++)
<a name="l00310"></a>00310         sum += <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,i);
<a name="l00311"></a>00311     <span class="keywordflow">return</span> sum;
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a><a class="code" href="classcorecvs_1_1Matrix.html#a152506e1afd1a9ac8ec066e7104f2f45">00314</a> <span class="keywordtype">double</span> <a class="code" href="classcorecvs_1_1Matrix.html#a152506e1afd1a9ac8ec066e7104f2f45">Matrix::frobeniusNorm</a>()<span class="keyword"> const</span>
<a name="l00315"></a>00315 <span class="keyword"></span>{
<a name="l00316"></a>00316     <span class="keywordtype">double</span> norm = 0.0;
<a name="l00317"></a>00317     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ; row++)
<a name="l00318"></a>00318     {
<a name="l00319"></a>00319         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> column = 0; column &lt; <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> ; column++)
<a name="l00320"></a>00320         {
<a name="l00321"></a>00321             <span class="keywordtype">double</span> val = <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, column);
<a name="l00322"></a>00322             norm += val * val;
<a name="l00323"></a>00323         }
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325     <span class="keywordflow">return</span> norm;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="matrix_8cpp.html#a48e45244984676be7855402fe2b763ba">00330</a> <span class="preprocessor">#define Sign(u,v)               ( (v)&gt;=0.0 ? Abs(u) : -Abs(u) )</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span>
<a name="l00332"></a><a class="code" href="matrix_8cpp.html#a02ad34859dc9a7d8fb661ba7b9e1a63b">00332</a> <span class="preprocessor">#define Max(u,v)                ( (u)&gt;(v)?  (u) : (v) )</span>
<a name="l00333"></a>00333 <span class="preprocessor"></span>
<a name="l00334"></a><a class="code" href="matrix_8cpp.html#aa6e7032f5dccdc69d2946c33a916b323">00334</a> <span class="preprocessor">#define Abs(x)                  ( (x)&gt;0.0?  (x) : (-(x)) )</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>
<a name="l00336"></a><a class="code" href="classcorecvs_1_1Matrix.html#a66cacd73ec0df2f145f04d963f385121">00336</a> <span class="keywordtype">void</span> <a class="code" href="classcorecvs_1_1Matrix.html#a66cacd73ec0df2f145f04d963f385121">Matrix::svdDesc</a> (<a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a> *A, <a class="code" href="classcorecvs_1_1Vector3d.html">Vector3dd</a> *W, <a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a> *V)
<a name="l00337"></a>00337 {
<a name="l00338"></a>00338     <a class="code" href="classcorecvs_1_1Matrix.html#ab00a85b071aab144f3a2860189150e7f" title="This method contains SVD implementation.">svd</a> (A, W, V);
<a name="l00339"></a>00339     <span class="keywordflow">if</span> (W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(0) &lt; W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(1)) { A-&gt;<a class="code" href="classcorecvs_1_1Matrix33.html#a1f0efa694ecb5c972ba08f66a216c2ca">swapColumns</a>(0,1); V-&gt;<a class="code" href="classcorecvs_1_1Matrix33.html#a1f0efa694ecb5c972ba08f66a216c2ca">swapColumns</a>(0,1); std::swap(W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(0), W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(1)); };
<a name="l00340"></a>00340     <span class="keywordflow">if</span> (W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(0) &lt; W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(2)) { A-&gt;<a class="code" href="classcorecvs_1_1Matrix33.html#a1f0efa694ecb5c972ba08f66a216c2ca">swapColumns</a>(0,2); V-&gt;<a class="code" href="classcorecvs_1_1Matrix33.html#a1f0efa694ecb5c972ba08f66a216c2ca">swapColumns</a>(0,2); std::swap(W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(0), W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(2)); };
<a name="l00341"></a>00341     <span class="keywordflow">if</span> (W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(1) &lt; W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(2)) { A-&gt;<a class="code" href="classcorecvs_1_1Matrix33.html#a1f0efa694ecb5c972ba08f66a216c2ca">swapColumns</a>(1,2); V-&gt;<a class="code" href="classcorecvs_1_1Matrix33.html#a1f0efa694ecb5c972ba08f66a216c2ca">swapColumns</a>(1,2); std::swap(W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(1), W-&gt;<a class="code" href="classcorecvs_1_1FixedVectorBase.html#ac481e05c5a98c6cda41137d63abe0743">at</a>(2)); };
<a name="l00342"></a>00342 }
<a name="l00343"></a>00343 
<a name="l00344"></a><a class="code" href="classcorecvs_1_1Matrix.html#adb561c0b87af27995ae73c4c44688cc1">00344</a> <span class="keywordtype">void</span> <a class="code" href="classcorecvs_1_1Matrix.html#ab00a85b071aab144f3a2860189150e7f" title="This method contains SVD implementation.">Matrix::svd</a> (<a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a> *A, <a class="code" href="classcorecvs_1_1Vector3d.html">Vector3dd</a> *W, <a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a> *V)
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> mA(*A);
<a name="l00347"></a>00347     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> mW(1,3);
<a name="l00348"></a>00348     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> mV(3,3);
<a name="l00349"></a>00349     <a class="code" href="classcorecvs_1_1Matrix.html#ab00a85b071aab144f3a2860189150e7f" title="This method contains SVD implementation.">svd</a> (&amp;mA, &amp;mW, &amp;mV);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     *A = (<a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a>)mA;
<a name="l00352"></a>00352     *W = <a class="code" href="namespacecorecvs.html#a8c6504d3d8b574bfb908b9fe5a7a3974">Vector3dd</a>(mW.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,0),mW.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,1),mW.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,2));
<a name="l00353"></a>00353     *V = (<a class="code" href="classcorecvs_1_1Matrix33.html" title="Class describes the 3 by 3 matrix.">Matrix33</a>)mV;
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 <span class="comment"></span>
<a name="l00356"></a>00356 <span class="comment">/**</span>
<a name="l00357"></a>00357 <span class="comment"> * \brief Solves the linear equation.</span>
<a name="l00358"></a>00358 <span class="comment"> *</span>
<a name="l00359"></a>00359 <span class="comment"> * This functions solves the equation</span>
<a name="l00360"></a>00360 <span class="comment"> * \f[</span>
<a name="l00361"></a>00361 <span class="comment"> *    Ax = B</span>
<a name="l00362"></a>00362 <span class="comment"> * \f]</span>
<a name="l00363"></a>00363 <span class="comment"> * by the Gaussian method of eliminating variables.</span>
<a name="l00364"></a>00364 <span class="comment"> *</span>
<a name="l00365"></a>00365 <span class="comment"> *</span>
<a name="l00366"></a>00366 <span class="comment"> */</span>
<a name="l00367"></a><a class="code" href="classcorecvs_1_1Matrix.html#a8341d8862e36ff9122073bbedf9551bd">00367</a> <span class="keywordtype">bool</span> <a class="code" href="classcorecvs_1_1Matrix.html#a8341d8862e36ff9122073bbedf9551bd" title="Solves the linear equation.">Matrix::matrixSolveGaussian</a>(<a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *A, <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *B)
<a name="l00368"></a>00368 {
<a name="l00369"></a>00369     <a class="code" href="global_8h.html#a85ed9d5111117cce8643d0c0a94cc586">ASSERT_FALSE</a>(A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> != A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> || A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> != B-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> || B-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> != 1, <span class="stringliteral">&quot;Matrix has wrong sizes&quot;</span>);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371     <span class="keywordtype">int</span> row, column, rowRunner, runner;
<a name="l00372"></a>00372     <span class="keywordtype">int</span> n = A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>;
<a name="l00373"></a>00373     <span class="comment">/* Walk thought the matrix from left to right */</span>
<a name="l00374"></a>00374     <span class="keywordflow">for</span> (column = 0; column &lt; n; column++)
<a name="l00375"></a>00375     {
<a name="l00376"></a>00376         <span class="comment">/* Find the row absolute maximum and row number with maximum */</span>
<a name="l00377"></a>00377         <span class="keywordtype">int</span> rowWithMax = -1;
<a name="l00378"></a>00378         <span class="keywordtype">double</span> maxInColumn = 0.0;
<a name="l00379"></a>00379         <span class="keywordflow">for</span> (row = column; row &lt; n; row ++)
<a name="l00380"></a>00380         {
<a name="l00381"></a>00381             <span class="keywordtype">double</span> absA = fabs (A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row,column));
<a name="l00382"></a>00382             <span class="keywordflow">if</span> (absA &gt; maxInColumn)
<a name="l00383"></a>00383             {
<a name="l00384"></a>00384                 maxInColumn = absA;
<a name="l00385"></a>00385                 rowWithMax = row;
<a name="l00386"></a>00386             }
<a name="l00387"></a>00387         }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389         <span class="keywordflow">if</span> (rowWithMax == -1) {
<a name="l00390"></a>00390             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00391"></a>00391             <span class="keywordflow">if</span> (B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column,0) != 0)
<a name="l00392"></a>00392                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00393"></a>00393             <span class="keywordflow">for</span> (rowRunner = 0; rowRunner &lt; n; rowRunner++)
<a name="l00394"></a>00394                 <span class="keywordflow">if</span> (A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column,rowRunner) != 0)
<a name="l00395"></a>00395                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397         <span class="comment">// Now we will work with the row of the same number as the column</span>
<a name="l00398"></a>00398         row = column;
<a name="l00399"></a>00399         <span class="comment">// Now put the row to the i-th position by interchange</span>
<a name="l00400"></a>00400         <span class="keywordflow">if</span> (rowWithMax != row)
<a name="l00401"></a>00401         {
<a name="l00402"></a>00402             <span class="keywordtype">double</span> tmp;
<a name="l00403"></a>00403             <span class="keywordflow">for</span> (rowRunner = 0; rowRunner &lt; n; rowRunner ++)
<a name="l00404"></a>00404             {
<a name="l00405"></a>00405                 tmp = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, rowRunner);
<a name="l00406"></a>00406                 A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row, rowRunner) = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(rowWithMax, rowRunner);
<a name="l00407"></a>00407                 A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(rowWithMax, rowRunner) = tmp;
<a name="l00408"></a>00408             }
<a name="l00409"></a>00409             tmp = B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row,0);
<a name="l00410"></a>00410             B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(row,0) = B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(rowWithMax,0);
<a name="l00411"></a>00411             B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(rowWithMax,0) = tmp;
<a name="l00412"></a>00412         }
<a name="l00413"></a>00413         <span class="comment">// And now do the correction of all the rows</span>
<a name="l00414"></a>00414         <span class="comment">// First divide all the row by the value of (column, row)</span>
<a name="l00415"></a>00415         <span class="keywordtype">double</span> <a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a> = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column, column);
<a name="l00416"></a>00416         <span class="keywordflow">for</span> (runner = column + 1; runner &lt; n; runner++)
<a name="l00417"></a>00417         {
<a name="l00418"></a>00418             <span class="keywordtype">double</span> d = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(runner, column);
<a name="l00419"></a>00419             <span class="keywordflow">for</span> (rowRunner = column; rowRunner &lt; n; rowRunner++)
<a name="l00420"></a>00420             {
<a name="l00421"></a>00421                 <span class="keywordflow">if</span> (d != 0) {
<a name="l00422"></a>00422                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(runner, rowRunner) = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(runner, rowRunner) * a - A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column, rowRunner) * d;
<a name="l00423"></a>00423                 }
<a name="l00424"></a>00424             }
<a name="l00425"></a>00425             <span class="keywordflow">if</span> (d != 0) {
<a name="l00426"></a>00426                 B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(runner,0) = B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(runner, 0) * a - B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(column,0) * d;
<a name="l00427"></a>00427             }
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429     }
<a name="l00430"></a>00430     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = n - 1; i &gt;= 0; i --)
<a name="l00431"></a>00431     {
<a name="l00432"></a>00432         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; n; j ++)
<a name="l00433"></a>00433         {
<a name="l00434"></a>00434             B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, 0) -= B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, 0) * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, j);
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436         B-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, 0) /= A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, i);
<a name="l00437"></a>00437     }
<a name="l00438"></a>00438     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00439"></a>00439 }
<a name="l00440"></a>00440 <span class="comment"></span>
<a name="l00441"></a>00441 <span class="comment">/**</span>
<a name="l00442"></a>00442 <span class="comment"> * This function returns an inverse of the matrix.</span>
<a name="l00443"></a>00443 <span class="comment"> *</span>
<a name="l00444"></a>00444 <span class="comment"> * The calculation is done through LU decomposition do far</span>
<a name="l00445"></a>00445 <span class="comment"> *</span>
<a name="l00446"></a>00446 <span class="comment"> * http://en.wikipedia.org/wiki/Gaussian_elimination</span>
<a name="l00447"></a>00447 <span class="comment"> * TODO: http://en.wikipedia.org/wiki/Gauss%E2%80%93Jordan_elimination</span>
<a name="l00448"></a>00448 <span class="comment"> *</span>
<a name="l00449"></a>00449 <span class="comment"> * \attention No check is done, if the matrix is invertible or not</span>
<a name="l00450"></a>00450 <span class="comment"> *</span>
<a name="l00451"></a>00451 <span class="comment"> * \return The \f$I^{-1}\f$</span>
<a name="l00452"></a>00452 <span class="comment"> *</span>
<a name="l00453"></a>00453 <span class="comment"> * */</span>
<a name="l00454"></a><a class="code" href="classcorecvs_1_1Matrix.html#aeb56de4494cc7520a587548b3c330084">00454</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="classcorecvs_1_1Matrix.html#aeb56de4494cc7520a587548b3c330084" title="This function returns an inverse of the matrix.">Matrix::inv</a>()<span class="keyword"> const</span>
<a name="l00455"></a>00455 <span class="keyword"></span>{
<a name="l00456"></a>00456     <span class="keywordtype">unsigned</span> i, j, k;
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="keywordtype">double</span> multiplier;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> == this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="stringliteral">&quot;Matrix should be square to invert.&quot;</span>);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     <span class="keywordtype">unsigned</span> rank = this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00463"></a>00463     <span class="comment">// Start with identity matrix</span>
<a name="l00464"></a>00464     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(rank, rank, 1.0);
<a name="l00465"></a>00465     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> copy(<span class="keyword">this</span>);
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <span class="keywordflow">for</span> (i = 0; i &lt; rank; ++i)
<a name="l00468"></a>00468     {
<a name="l00469"></a>00469         <span class="keywordtype">double</span> divider = copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,i);
<a name="l00470"></a>00470         <span class="keywordflow">if</span> (fabs(divider) == 0)
<a name="l00471"></a>00471         {
<a name="l00472"></a>00472             <span class="keywordflow">return</span> result;
<a name="l00473"></a>00473         }
<a name="l00474"></a>00474         <span class="keywordflow">for</span> (j = 0; j &lt; rank; ++j)
<a name="l00475"></a>00475         {
<a name="l00476"></a>00476               copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, j) /= divider;
<a name="l00477"></a>00477             result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, j) /= divider;
<a name="l00478"></a>00478         }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480         <span class="keywordflow">for</span> (j = i + 1; j &lt; rank; ++j)
<a name="l00481"></a>00481         {
<a name="l00482"></a>00482             multiplier = copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j,i);
<a name="l00483"></a>00483             <span class="keywordflow">if</span> (fabs (copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j,i)) &gt; 0.0)
<a name="l00484"></a>00484             {
<a name="l00485"></a>00485                 <span class="keywordflow">for</span> (k = 0; k &lt; rank; ++k)
<a name="l00486"></a>00486                 {
<a name="l00487"></a>00487                       copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, k) -=   copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, k) * multiplier;
<a name="l00488"></a>00488                     result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, k) -= result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, k) * multiplier;
<a name="l00489"></a>00489                 }
<a name="l00490"></a>00490             }
<a name="l00491"></a>00491         }
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="keywordflow">for</span> (i = rank; i &gt; 0; --i)
<a name="l00495"></a>00495     {
<a name="l00496"></a>00496         <span class="keywordflow">for</span> (j = 0; j + 1 &lt; i; ++j)
<a name="l00497"></a>00497         {
<a name="l00498"></a>00498             multiplier = copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j,i - 1);
<a name="l00499"></a>00499             <span class="keywordflow">for</span> (k = 0; k &lt; rank; k++)
<a name="l00500"></a>00500             {
<a name="l00501"></a>00501                  copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, k) -=   copy.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i - 1, k) * multiplier;
<a name="l00502"></a>00502                result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, k) -= result.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i - 1, k) * multiplier;
<a name="l00503"></a>00503             }
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     <span class="keywordflow">return</span> result;
<a name="l00508"></a>00508 }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 
<a name="l00512"></a><a class="code" href="classcorecvs_1_1Matrix.html#a67ff682212801703e75602acf3859d1f">00512</a> <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="classcorecvs_1_1Matrix.html#a67ff682212801703e75602acf3859d1f">Matrix::invSVD</a>()<span class="keyword"> const</span>
<a name="l00513"></a>00513 <span class="keyword"></span>{
<a name="l00514"></a>00514     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> == this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="stringliteral">&quot;Matrix should be square to invert.&quot;</span>);
<a name="l00515"></a>00515     <span class="keywordtype">int</span> rank = this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00516"></a>00516     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespaceClusteringDirectionType.html#ac6c734163930f84155fdf639ea012599a3bf817574a3d248fe1bb494e386ef9c7" title="X Sort by X axis.">X</a>(<span class="keyword">this</span>);
<a name="l00517"></a>00517     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(rank, rank, 1.0);
<a name="l00518"></a>00518     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> W(1,    rank);
<a name="l00519"></a>00519     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> V(rank, rank);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <a class="code" href="classcorecvs_1_1Matrix.html#ab00a85b071aab144f3a2860189150e7f" title="This method contains SVD implementation.">Matrix::svd</a> (&amp;X, &amp;W, &amp;V);
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     X.<a class="code" href="classcorecvs_1_1Matrix.html#a592174ecffa431b0f6b2a47aeee2ad23">transpose</a>();
<a name="l00524"></a>00524   <span class="comment">//  cout &lt;&lt; &quot;Singular:&quot; &lt;&lt; W &lt;&lt; endl;</span>
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; rank ; i++)
<a name="l00527"></a>00527     {
<a name="l00528"></a>00528         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; rank ; j++)
<a name="l00529"></a>00529         {
<a name="l00530"></a>00530             <span class="keywordflow">if</span> (W.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,i) &gt; 1e-5)
<a name="l00531"></a>00531                 X.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,j) /= W.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,i);
<a name="l00532"></a>00532         }
<a name="l00533"></a>00533     }
<a name="l00534"></a>00534     <span class="keywordflow">return</span> V * <a class="code" href="namespaceClusteringDirectionType.html#ac6c734163930f84155fdf639ea012599a3bf817574a3d248fe1bb494e386ef9c7" title="X Sort by X axis.">X</a>;
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a><a class="code" href="classcorecvs_1_1Matrix.html#a474996bf97258f5ecd066d1f5345d00d">00537</a> <span class="keywordtype">double</span> <a class="code" href="classcorecvs_1_1Matrix.html#a474996bf97258f5ecd066d1f5345d00d">Matrix::detSVD</a>()<span class="keyword"> const</span>
<a name="l00538"></a>00538 <span class="keyword"></span>{
<a name="l00539"></a>00539     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>(this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> == this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>, <span class="stringliteral">&quot;Matrix should be square to invert.&quot;</span>);
<a name="l00540"></a>00540     <span class="keywordtype">int</span> rank = this-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00541"></a>00541     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> <a class="code" href="namespaceClusteringDirectionType.html#ac6c734163930f84155fdf639ea012599a3bf817574a3d248fe1bb494e386ef9c7" title="X Sort by X axis.">X</a>(<span class="keyword">this</span>);
<a name="l00542"></a>00542     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> result(rank, rank, 1.0);
<a name="l00543"></a>00543     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> W(1,    rank);
<a name="l00544"></a>00544     <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> V(rank, rank);
<a name="l00545"></a>00545 
<a name="l00546"></a>00546     <a class="code" href="classcorecvs_1_1Matrix.html#ab00a85b071aab144f3a2860189150e7f" title="This method contains SVD implementation.">Matrix::svd</a> (&amp;X, &amp;W, &amp;V);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="keywordtype">double</span> det = 1.0;
<a name="l00549"></a>00549     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; rank ; i++)
<a name="l00550"></a>00550     {
<a name="l00551"></a>00551        det *= W.<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,i);
<a name="l00552"></a>00552     }
<a name="l00553"></a>00553     <span class="keywordflow">return</span> det;
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 <span class="comment"></span>
<a name="l00556"></a>00556 <span class="comment">/**</span>
<a name="l00557"></a>00557 <span class="comment"> *</span>
<a name="l00558"></a>00558 <span class="comment"> * \brief This method contains SVD implementation.</span>
<a name="l00559"></a>00559 <span class="comment"> *</span>
<a name="l00560"></a>00560 <span class="comment"> * \remark This SVD is not http://en.wikipedia.org/wiki/Snayperskaya_Vintovka_Dragunova</span>
<a name="l00561"></a>00561 <span class="comment"> *</span>
<a name="l00562"></a>00562 <span class="comment"> * \remark I have used an existing solution with unclear license. So far let it be so.</span>
<a name="l00563"></a>00563 <span class="comment"> *  In fact this solution is a reworked solution from &quot;Numerical Recipies in C&quot;, so it it will</span>
<a name="l00564"></a>00564 <span class="comment"> *  be easy to re-implement it to make it absolutely clean.</span>
<a name="l00565"></a>00565 <span class="comment"> *</span>
<a name="l00566"></a>00566 <span class="comment"> *  Seems like this code is an semi-automatic translation from Fortran.</span>
<a name="l00567"></a>00567 <span class="comment"> *</span>
<a name="l00568"></a>00568 <span class="comment"> *</span>
<a name="l00569"></a>00569 <span class="comment"> *  \author Alexander Pimenov based on code form &quot;Numerical Recipies in C&quot; and looking over Tina code</span>
<a name="l00570"></a>00570 <span class="comment"> */</span>
<a name="l00571"></a>00571 <span class="comment"></span>
<a name="l00572"></a>00572 <span class="comment">/**</span>
<a name="l00573"></a>00573 <span class="comment"> * Given a matrix A, Matrix::svd() computes its singular value decomposition, A = U W V^T.</span>
<a name="l00574"></a>00574 <span class="comment"> * The matrix U replaces A on output. The diagonal matrix of singular values W is output</span>
<a name="l00575"></a>00575 <span class="comment"> * as a matrix W. The matrix V (not the transpose V T ) is output as V.</span>
<a name="l00576"></a>00576 <span class="comment"> */</span>
<a name="l00577"></a><a class="code" href="classcorecvs_1_1Matrix.html#ab00a85b071aab144f3a2860189150e7f">00577</a> <span class="keywordtype">void</span> <a class="code" href="classcorecvs_1_1Matrix.html#ab00a85b071aab144f3a2860189150e7f" title="This method contains SVD implementation.">Matrix::svd</a> (<a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *A, <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *W, <a class="code" href="classcorecvs_1_1Matrix.html">Matrix</a> *V)
<a name="l00578"></a>00578 {
<a name="l00579"></a>00579     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>((A != NULL &amp;&amp; W != NULL &amp;&amp; V != NULL), <span class="stringliteral">&quot;NULL input Matrix\n&quot;</span>);
<a name="l00580"></a>00580 
<a name="l00581"></a>00581     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>((W-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> ==    1 &amp;&amp; W-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>), <span class="stringliteral">&quot;Matrix W has wrong size\n&quot;</span> );
<a name="l00582"></a>00582     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>((A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == V-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a> &amp;&amp; A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a> == V-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>),<span class="stringliteral">&quot;Matrix V has wrong size\n&quot;</span>);
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="keywordtype">int</span> n = A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a7ff3d372b9a613e451a379a4427e2623">w</a>;
<a name="l00585"></a>00585     <span class="keywordtype">int</span> m = A-&gt;<a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00586"></a>00586 
<a name="l00587"></a>00587     <span class="comment">/* BUG `nm&#39; may be used uninitialized in this function */</span>
<a name="l00588"></a>00588     <span class="keywordtype">int</span>     flag, i, its, j, jj, k, l=0, nm, nm1 = n - 1, mm1 = m - 1;
<a name="l00589"></a>00589     <span class="keywordtype">double</span>  c, f, <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>, s, x, y, z;
<a name="l00590"></a>00590     <span class="keywordtype">double</span>  anorm = 0.0;
<a name="l00591"></a>00591     <span class="keywordtype">double</span>  g = 0.0;
<a name="l00592"></a>00592     <span class="keywordtype">double</span> scale = 0.0;
<a name="l00593"></a>00593     <span class="keywordtype">double</span> *rv1;
<a name="l00594"></a>00594 
<a name="l00595"></a>00595     <a class="code" href="global_8h.html#a85ed9d5111117cce8643d0c0a94cc586">ASSERT_FALSE</a>((m &lt; n), <span class="stringliteral">&quot;SVDCMP: You must augment A with extra zero rows&quot;</span>);
<a name="l00596"></a>00596     <a class="code" href="global_8h.html#aa38fef22b6434d04309637be89dac846">ASSERT_TRUE</a>(n &gt; 0 , <span class="stringliteral">&quot;A width should not be zero&quot;</span>);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598     rv1 = <span class="keyword">new</span> <span class="keywordtype">double</span>[n];
<a name="l00599"></a>00599 
<a name="l00600"></a>00600     <span class="comment">/* Householder reduction to bidigonal form */</span>
<a name="l00601"></a>00601     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00602"></a>00602     {
<a name="l00603"></a>00603         l = i + 1;
<a name="l00604"></a>00604         rv1[i] = scale * g;
<a name="l00605"></a>00605         g = s = scale = 0.0;
<a name="l00606"></a>00606         <span class="keywordflow">if</span> (i &lt; m)
<a name="l00607"></a>00607         {
<a name="l00608"></a>00608             <span class="keywordflow">for</span> (k = i; k &lt; m; k++)
<a name="l00609"></a>00609                 scale += fabs(A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,i));
<a name="l00610"></a>00610             <span class="keywordflow">if</span> (scale)
<a name="l00611"></a>00611             {
<a name="l00612"></a>00612                 <span class="keywordflow">for</span> (k = i; k &lt; m; k++)
<a name="l00613"></a>00613                 {
<a name="l00614"></a>00614                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,i) /= scale;
<a name="l00615"></a>00615                     s += A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,i) * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,i);
<a name="l00616"></a>00616                 }
<a name="l00617"></a>00617                 f = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,i);
<a name="l00618"></a>00618                 g = -<a class="code" href="matrix_8cpp.html#a48e45244984676be7855402fe2b763ba">Sign</a>(sqrt(s), f);
<a name="l00619"></a>00619                 h = f * g - s;
<a name="l00620"></a>00620                 A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,i) = f - g;
<a name="l00621"></a>00621                 <span class="keywordflow">if</span> (i != nm1)
<a name="l00622"></a>00622                 {
<a name="l00623"></a>00623                     <span class="keywordflow">for</span> (j = l; j &lt; n; j++)
<a name="l00624"></a>00624                     {
<a name="l00625"></a>00625                         <span class="keywordflow">for</span> (s = 0.0, k = i; k &lt; m; k++)
<a name="l00626"></a>00626                             s += A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,i) * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,j);
<a name="l00627"></a>00627                         f = s / <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00628"></a>00628                         <span class="keywordflow">for</span> (k = i; k &lt; m; k++)
<a name="l00629"></a>00629                             A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,j) += f * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,i);
<a name="l00630"></a>00630                     }
<a name="l00631"></a>00631                 }
<a name="l00632"></a>00632                 <span class="keywordflow">for</span> (k = i; k &lt; m; k++)
<a name="l00633"></a>00633                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k,i) *= scale;
<a name="l00634"></a>00634             }
<a name="l00635"></a>00635         }
<a name="l00636"></a>00636         W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0,i) = scale * g;
<a name="l00637"></a>00637         g = s = scale = 0.0;
<a name="l00638"></a>00638         <span class="keywordflow">if</span> (i &lt; m &amp;&amp; i != nm1)
<a name="l00639"></a>00639         {
<a name="l00640"></a>00640             <span class="keywordflow">for</span> (k = l; k &lt; n; k++)
<a name="l00641"></a>00641                 scale += fabs(A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,k));
<a name="l00642"></a>00642             <span class="keywordflow">if</span> (scale)
<a name="l00643"></a>00643             {
<a name="l00644"></a>00644                 <span class="keywordflow">for</span> (k = l; k &lt; n; k++)
<a name="l00645"></a>00645                 {
<a name="l00646"></a>00646                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,k) /= scale;
<a name="l00647"></a>00647                     s += A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,k) * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,k);
<a name="l00648"></a>00648                 }
<a name="l00649"></a>00649                 f = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,l);
<a name="l00650"></a>00650                 g = -<a class="code" href="matrix_8cpp.html#a48e45244984676be7855402fe2b763ba">Sign</a>(sqrt(s), f);
<a name="l00651"></a>00651                 h = f * g - s;
<a name="l00652"></a>00652                 A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,l) = f - g;
<a name="l00653"></a>00653                 <span class="keywordflow">for</span> (k = l; k &lt; n; k++)
<a name="l00654"></a>00654                     rv1[k] = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,k) / <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00655"></a>00655                 <span class="keywordflow">if</span> (i != mm1)
<a name="l00656"></a>00656                 {
<a name="l00657"></a>00657                     <span class="keywordflow">for</span> (j = l; j &lt; m; j++)
<a name="l00658"></a>00658                     {
<a name="l00659"></a>00659                         <span class="keywordflow">for</span> (s = 0.0, k = l; k &lt; n; k++)
<a name="l00660"></a>00660                             s += A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j,k) * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,k);
<a name="l00661"></a>00661                         <span class="keywordflow">for</span> (k = l; k &lt; n; k++)
<a name="l00662"></a>00662                             A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j,k) += s * rv1[k];
<a name="l00663"></a>00663                     }
<a name="l00664"></a>00664                 }
<a name="l00665"></a>00665                 <span class="keywordflow">for</span> (k = l; k &lt; n; k++)
<a name="l00666"></a>00666                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i,k) *= scale;
<a name="l00667"></a>00667             }
<a name="l00668"></a>00668         }
<a name="l00669"></a>00669         anorm = <a class="code" href="matrix_8cpp.html#a02ad34859dc9a7d8fb661ba7b9e1a63b">Max</a>(anorm, (fabs(W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>( 0, i)) + fabs(rv1[i])));
<a name="l00670"></a>00670     }
<a name="l00671"></a>00671 
<a name="l00672"></a>00672         <span class="comment">/* Accumulation of right-hand transformations */</span>
<a name="l00673"></a>00673         <span class="keywordflow">for</span> (i = n - 1; i &gt;= 0; i--)
<a name="l00674"></a>00674         {
<a name="l00675"></a>00675             <span class="keywordflow">if</span> (i &lt; nm1)
<a name="l00676"></a>00676             {
<a name="l00677"></a>00677                 <span class="keywordflow">if</span> (g)
<a name="l00678"></a>00678                 {
<a name="l00679"></a>00679                     <span class="comment">/* double division to avoid possible underflow */</span>
<a name="l00680"></a>00680                     <span class="keywordflow">for</span> (j = l; j &lt; n; j++)
<a name="l00681"></a>00681                         V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>( j, i) = (A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>( i, j) / A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>( i, l)) / g;
<a name="l00682"></a>00682                     <span class="keywordflow">for</span> (j = l; j &lt; n; j++)
<a name="l00683"></a>00683                     {
<a name="l00684"></a>00684                         <span class="keywordflow">for</span> (s = 0.0, k = l; k &lt; n; k++)
<a name="l00685"></a>00685                             s += A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, k) * V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k, j);
<a name="l00686"></a>00686                         <span class="keywordflow">for</span> (k = l; k &lt; n; k++)
<a name="l00687"></a>00687                             V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k, j) += s * V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k, i);
<a name="l00688"></a>00688                     }
<a name="l00689"></a>00689                 }
<a name="l00690"></a>00690                 <span class="keywordflow">for</span> (j = l; j &lt; n; j++)
<a name="l00691"></a>00691                     V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, j) = V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, i) = 0.0;
<a name="l00692"></a>00692             }
<a name="l00693"></a>00693             V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, i) = 1.0;
<a name="l00694"></a>00694             g = rv1[i];
<a name="l00695"></a>00695             l = i;
<a name="l00696"></a>00696         }
<a name="l00697"></a>00697         <span class="comment">/* Accumulation of left-hand transformations */</span>
<a name="l00698"></a>00698         <span class="keywordflow">for</span> (i = n - 1; i &gt;= 0; i--)
<a name="l00699"></a>00699         {
<a name="l00700"></a>00700             l = i + 1;
<a name="l00701"></a>00701             g = W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, i);
<a name="l00702"></a>00702             <span class="keywordflow">if</span> (i &lt; nm1)
<a name="l00703"></a>00703                 <span class="keywordflow">for</span> (j = l; j &lt; n; j++)
<a name="l00704"></a>00704                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, j) = 0.0;
<a name="l00705"></a>00705             <span class="keywordflow">if</span> (g)
<a name="l00706"></a>00706             {
<a name="l00707"></a>00707                 g = 1.0 / g;
<a name="l00708"></a>00708                 <span class="keywordflow">if</span> (i != nm1)
<a name="l00709"></a>00709                 {
<a name="l00710"></a>00710                     <span class="keywordflow">for</span> (j = l; j &lt; n; j++)
<a name="l00711"></a>00711                     {
<a name="l00712"></a>00712                         <span class="keywordflow">for</span> (s = 0.0, k = l; k &lt; m; k++)
<a name="l00713"></a>00713                             s += A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k, i) * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k, j);
<a name="l00714"></a>00714                         f = (s / A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, i)) * g;
<a name="l00715"></a>00715                         <span class="keywordflow">for</span> (k = i; k &lt; m; k++)
<a name="l00716"></a>00716                             A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k, j) += f * A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(k, i);
<a name="l00717"></a>00717                     }
<a name="l00718"></a>00718                 }
<a name="l00719"></a>00719                 <span class="keywordflow">for</span> (j = i; j &lt; m; j++)
<a name="l00720"></a>00720                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, i) *= g;
<a name="l00721"></a>00721             } <span class="keywordflow">else</span>
<a name="l00722"></a>00722                 <span class="keywordflow">for</span> (j = i; j &lt; m; j++)
<a name="l00723"></a>00723                     A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, i) = 0.0;
<a name="l00724"></a>00724             ++A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(i, i);
<a name="l00725"></a>00725         }
<a name="l00726"></a>00726         <span class="comment">/* diagonalization of the bidigonal form */</span>
<a name="l00727"></a>00727         <span class="keywordflow">for</span> (k = n - 1; k &gt;= 0; k--)
<a name="l00728"></a>00728         {                           <span class="comment">/* loop over singlar values */</span>
<a name="l00729"></a>00729             <span class="keywordflow">for</span> (its = 0; its &lt; 30; its++)
<a name="l00730"></a>00730             {                       <span class="comment">/* loop over allowed iterations */</span>
<a name="l00731"></a>00731                 flag = 1;
<a name="l00732"></a>00732                 <span class="keywordflow">for</span> (l = k; l &gt;= 0; l--)
<a name="l00733"></a>00733                 {                   <span class="comment">/* test for splitting */</span>
<a name="l00734"></a>00734                     nm = l - 1;     <span class="comment">/* note that rv1[l] is always zero */</span>
<a name="l00735"></a>00735                     <span class="keywordflow">if</span> (<a class="code" href="matrix_8cpp.html#aa6e7032f5dccdc69d2946c33a916b323">Abs</a>(rv1[l]) + anorm == anorm)
<a name="l00736"></a>00736                     {
<a name="l00737"></a>00737                         flag = 0;
<a name="l00738"></a>00738                         <span class="keywordflow">break</span>;
<a name="l00739"></a>00739                     }
<a name="l00740"></a>00740                     <span class="keywordflow">if</span> (fabs(W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, nm)) + anorm == anorm)
<a name="l00741"></a>00741                         <span class="keywordflow">break</span>;
<a name="l00742"></a>00742                 }
<a name="l00743"></a>00743                 <span class="keywordflow">if</span> (flag)
<a name="l00744"></a>00744                 {
<a name="l00745"></a>00745                     c = 0.0;        <span class="comment">/* cancellation of rv1[l], if l&gt;1 */</span>
<a name="l00746"></a>00746                     s = 1.0;
<a name="l00747"></a>00747                     <span class="keywordflow">for</span> (i = l; i &lt;= k; i++)
<a name="l00748"></a>00748                     {
<a name="l00749"></a>00749                         f = s * rv1[i];
<a name="l00750"></a>00750                         <span class="keywordflow">if</span> (<a class="code" href="matrix_8cpp.html#aa6e7032f5dccdc69d2946c33a916b323">Abs</a>(f) + anorm != anorm)
<a name="l00751"></a>00751                         {
<a name="l00752"></a>00752                             g = W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, i);
<a name="l00753"></a>00753                             h = <a class="code" href="namespacecorecvs.html#af76dfccc4f8b3f0a802cc2dd27a3b303">Vector2dd</a>(f, g).<a class="code" href="classcorecvs_1_1Vector2d.html#ab49b551bd23cad02283d6506884bef72">getLengthStable</a>();
<a name="l00754"></a>00754                             W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, i) = <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00755"></a>00755                             h = 1.0 / <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00756"></a>00756                             c = g * <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>;
<a name="l00757"></a>00757                             s = (-f * <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>);
<a name="l00758"></a>00758                             <span class="keywordflow">for</span> (j = 0; j &lt; m; j++)
<a name="l00759"></a>00759                             {
<a name="l00760"></a>00760                                 y = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, nm);
<a name="l00761"></a>00761                                 z = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, i);
<a name="l00762"></a>00762                                 A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>( j, nm) = y * c + z * s;
<a name="l00763"></a>00763                                 A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>( j, i) = z * c - y * s;
<a name="l00764"></a>00764                             }
<a name="l00765"></a>00765                         }
<a name="l00766"></a>00766                     }
<a name="l00767"></a>00767                 }
<a name="l00768"></a>00768                 z = W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, k);
<a name="l00769"></a>00769                 <span class="keywordflow">if</span> (l == k)
<a name="l00770"></a>00770                 {                   <span class="comment">/* convergence */</span>
<a name="l00771"></a>00771                     <span class="keywordflow">if</span> (z &lt; 0.0)
<a name="l00772"></a>00772                     {
<a name="l00773"></a>00773                         W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, k) = -z;
<a name="l00774"></a>00774                         <span class="keywordflow">for</span> (j = 0; j &lt; n; j++)
<a name="l00775"></a>00775                             V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, k) = (-V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(j, k));
<a name="l00776"></a>00776                     }
<a name="l00777"></a>00777                     <span class="keywordflow">break</span>;
<a name="l00778"></a>00778                 }
<a name="l00779"></a>00779                 <span class="keywordflow">if</span> (its == 30)
<a name="l00780"></a>00780                     printf(<span class="stringliteral">&quot;No convergence in 30 SVDCMP iterations&quot;</span>);
<a name="l00781"></a>00781                 x = W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, l);           <span class="comment">/* shift from bottom 2-by-2 minor */</span>
<a name="l00782"></a>00782                 nm = k - 1;
<a name="l00783"></a>00783                 y = W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, nm);
<a name="l00784"></a>00784                 g = rv1[nm];
<a name="l00785"></a>00785                 h = rv1[k];
<a name="l00786"></a>00786                 f = ((y - z) * (y + z) + (g - <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>) * (g + h)) / (2.0 * h * y);
<a name="l00787"></a>00787                 g = <a class="code" href="namespacecorecvs.html#af76dfccc4f8b3f0a802cc2dd27a3b303">Vector2dd</a>(f, 1.0).<a class="code" href="classcorecvs_1_1Vector2d.html#ab49b551bd23cad02283d6506884bef72">getLengthStable</a>();
<a name="l00788"></a>00788                 <span class="comment">/* next QR transformation */</span>
<a name="l00789"></a>00789                 f = ((x - z) * (x + z) + h * ((y / (f + <a class="code" href="matrix_8cpp.html#a48e45244984676be7855402fe2b763ba">Sign</a>(g, f))) - <a class="code" href="classcorecvs_1_1AbstractBufferParams.html#a88e969182e3f07bb3600de841b409e9b">h</a>)) / x;
<a name="l00790"></a>00790                 c = s = 1.0;
<a name="l00791"></a>00791                 <span class="keywordflow">for</span> (j = l; j &lt;= nm; j++)
<a name="l00792"></a>00792                 {
<a name="l00793"></a>00793                     i = j + 1;
<a name="l00794"></a>00794                     g = rv1[i];
<a name="l00795"></a>00795                     y = W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, i);
<a name="l00796"></a>00796                     h = s * g;
<a name="l00797"></a>00797                     g = c * g;
<a name="l00798"></a>00798                     z = <a class="code" href="namespacecorecvs.html#af76dfccc4f8b3f0a802cc2dd27a3b303">Vector2dd</a>(f,h).<a class="code" href="classcorecvs_1_1Vector2d.html#ab49b551bd23cad02283d6506884bef72">getLengthStable</a>();
<a name="l00799"></a>00799                     rv1[j] = z;
<a name="l00800"></a>00800                     c = f / z;
<a name="l00801"></a>00801                     s = h / z;
<a name="l00802"></a>00802                     f = x * c + g * s;
<a name="l00803"></a>00803                     g = g * c - x * s;
<a name="l00804"></a>00804                     h = y * s;
<a name="l00805"></a>00805                     y = y * c;
<a name="l00806"></a>00806                     <span class="keywordflow">for</span> (jj = 0; jj &lt; n; jj++)
<a name="l00807"></a>00807                     {
<a name="l00808"></a>00808                         x = V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, j);
<a name="l00809"></a>00809                         z = V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, i);
<a name="l00810"></a>00810                         V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, j) = x * c + z * s;
<a name="l00811"></a>00811                         V-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, i) = z * c - x * s;
<a name="l00812"></a>00812                     }
<a name="l00813"></a>00813                     z = <a class="code" href="namespacecorecvs.html#af76dfccc4f8b3f0a802cc2dd27a3b303">Vector2dd</a>(f,h).<a class="code" href="classcorecvs_1_1Vector2d.html#ab49b551bd23cad02283d6506884bef72">getLengthStable</a>();
<a name="l00814"></a>00814                     W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, j) = z;       <span class="comment">/* rotation can be arbitrary id z=0 */</span>
<a name="l00815"></a>00815                     <span class="keywordflow">if</span> (z)
<a name="l00816"></a>00816                     {
<a name="l00817"></a>00817                         z = 1.0 / z;
<a name="l00818"></a>00818                         c = f * z;
<a name="l00819"></a>00819                         s = h * z;
<a name="l00820"></a>00820                     }
<a name="l00821"></a>00821                     f = (c * g) + (s * y);
<a name="l00822"></a>00822                     x = (c * y) - (s * g);
<a name="l00823"></a>00823                     <span class="keywordflow">for</span> (jj = 0; jj &lt; m; jj++)
<a name="l00824"></a>00824                     {
<a name="l00825"></a>00825                         y = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, j);
<a name="l00826"></a>00826                         z = A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, i);
<a name="l00827"></a>00827                         A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, j) = y * c + z * s;
<a name="l00828"></a>00828                         A-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(jj, i) = z * c - y * s;
<a name="l00829"></a>00829                     }
<a name="l00830"></a>00830                 }
<a name="l00831"></a>00831                 rv1[l] = 0.0;
<a name="l00832"></a>00832                 rv1[k] = f;
<a name="l00833"></a>00833                 W-&gt;<a class="code" href="classcorecvs_1_1Matrix.html#a5b8b00c8bfc66549652e6c0610457254" title="The element getter for a matrix that is used like vector (i.e has height or width of 1)...">a</a>(0, k) = x;
<a name="l00834"></a>00834             }
<a name="l00835"></a>00835         }
<a name="l00836"></a>00836      <span class="keyword">delete</span>[] rv1;
<a name="l00837"></a>00837 }
<a name="l00838"></a>00838 
<a name="l00839"></a>00839 
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 
<a name="l00842"></a>00842 } <span class="comment">//namespace corecvs</span>
<a name="l00843"></a>00843 
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Nov 12 2013 23:44:36 for DeepView by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
